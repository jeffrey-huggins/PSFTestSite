function initCommunities(){var n=$("#CommunityTable").dataTable({bFilter:!1,bAutoWidth:!0,sScrollY:"600px",sDom:"frtS",iDisplayLength:-1,aoColumns:[null,null,null,{bSearchable:!1,bSortable:!1,sWidth:"20px"},{bSearchable:!1,bSortable:!1,sWidth:"20px"}],language:{emptyTable:"No Communities"}});$(".checkbox").click(function(){var t=$(this),n=$(this).is(":checked"),i=$(this).attr("id"),r=$(this).parents("tr").children(":first-child").text();$.ajax({url:path+"Base/ChangeDataFlgCom",dataType:"json",cache:!1,type:"POST",data:{community:i,dFlag:n,appCode:"ASAP"},success:function(i){i.Success||(t.prop("checked",!n),alert("Community has failed to be enabled/disabled. Please try again and if you see this message repeatedly the server may be down."))}})});$(".checkboxReport").click(function(){var t=$(this),n=$(this).is(":checked"),i=$(this).attr("id"),r=$(this).parents("tr").children(":first-child").text();$.ajax({url:path+"Base/ChangeReportFlgCom",dataType:"json",cache:!1,type:"POST",data:{community:i,dFlag:n,appCode:"ASAP"},success:function(i){i.Success||(t.prop("checked",!n),alert("Community report flag has failed to be enabled/disabled. Please try again and if you see this message repeatedly the server may be down."))}})})}function alreadyExist(n,t,i){var u,r,f;for(i||(i=0),u=t.dataTable().fnGetData(),r=0;r<u.length;r++)if(f=u[r][i],f.toLowerCase()===n.toLowerCase())return!0;return!1}function initComplaints(){var n=$("#complaintTypes").dataTable({bFilter:!1,bAutoWidth:!0,sScrollY:"200px",sDom:"frtS",iDisplayLength:-1,aoColumns:[{sWidth:"300px"},null,{bSortable:!1},{bSortable:!1},{bSortable:!1}],oLanguage:{sEmptyTable:"No Complaint Types"}}),t;n.fnSort([[1,"asc"]]);t=null;$("#complaintTypes").on("click",".EnableDisable",function(){var i=$(this),t=$(this).is(":checked"),r=$(this).parents("tr")[0],u=n.fnGetData(r);$.ajax({url:path+"ASAPHotlineAdmin/ChangeDataFlg",dataType:"json",cache:!1,type:"POST",data:{description:u[0],dFlag:t},success:function(n){n.Success||(i.prop("checked",!t),alert("Complaint Type has failed to be enabled/disabled. Please try again and if you see this message repeatedly the server may be down."))}})});$("#complaintTypes").on("click","a.delete",function(t){t.preventDefault();var i=$(this).parents("tr")[0],r=$(this).closest("tr").attr("id"),f=n.fnGetData(i),u=confirm("Are you sure you want to delete?");u&&$.ajax({url:path+"ASAPHotlineAdmin/DeleteRowAdmin",dataType:"json",cache:!1,type:"POST",data:{rowId:r},success:function(t){t.Success?n.fnDeleteRow(i):alert("Complaint Type has failed to be deleted. Please try again and if you see this message repeatedly the server may be down.")}})});$("#complaintTypes").on("click","a.edit",function(i){var r,u,f;i.preventDefault();r=$(this).parents("tr")[0];t!==null&&t!=r?(restoreRow(n,t),editRow(n,r),t=r):t==r&&this.innerHTML=="Save"?(u=$(this).closest("tr").attr("id"),f=saveRow(n,t,u),f&&(t=null)):(editRow(n,r),t=r)});$("#complaintTypes").on("click","a.cancel",function(t){t.preventDefault();var i=$(this).parents("tr")[0];restoreRow(n,i)});$("#complaintsTab").find("[type='submit']").click(function(n){n.preventDefault();var t=$("#complaintsTab form"),i=$("#NewComplaintType_ASAPComplaintTypeDesc").val();if(alreadyExist(i,$("#complaintTypes").dataTable()))return alert("Complaint Type already exists."),!1;if(!t.valid())return!1;$.ajax({url:t.attr("action"),dataType:"json",type:"POST",data:t.serialize(),success:function(n){var f,r,e,o;if(n.Success){var s=n.data.ASAPComplaintTypeDesc,h=n.data.SortOrder,u=n.data.DataEntryFlg,c=n.data.ASAPComplaintTypeId,i="EnableDisable";u&&(f='checked="checked"');r="<input "+f+' class="'+i+'" id="'+i+'" name="'+i+'" type="checkbox" value="'+u+'">';r+='<input name="'+i+'" type="hidden" value="false">';e=$("#complaintTypes").dataTable().fnAddData([s,h,r,'<a class="edit" href="">Edit<\/a>','<a class="delete" href="">Delete<\/a>']);o=$("#complaintTypes").dataTable().fnSettings().aoData[e[0]].nTr;o.setAttribute("id",c);t[0].reset()}else alert(n.message)},error:function(){alert("Server is not responding. Please reload page and try again")}})})}function initContacts(){var n=$("#contacts").dataTable({bFilter:!1,bAutoWidth:!0,sScrollY:"150px",sDom:"frtS",iDisplayLength:-1,aoColumns:[null,null,{bSortable:!1}],language:{emptyTable:"No Employees"}});$("#contacts").on("click","a.delete",function(t){t.preventDefault();var i=$(this).parents("tr")[0],r=$(this).closest("tr").attr("id"),u=confirm("Are you sure you want to delete?");u&&$.ajax({url:path+"ASAPHotlineAdmin/DeleteContact",dataType:"json",cache:!1,type:"POST",data:{rowId:r},success:function(t){t.Success?n.fnDeleteRow(i):alert("Contact has failed to be deleted. Please try again and if you see this message repeatedly the server may be down.")}})});$("#contactsTab").find("[type='submit']").click(function(n){n.preventDefault();var t=$("#contactsTab form");if(!t.valid())return!1;$.ajax({url:t.attr("action"),dataType:"json",type:"POST",data:t.serialize(),success:function(n){if(n.Success){var i=n.data.FirstName,r=n.data.LastName,u=r+", "+i,f=n.data.eMail,e=n.data.ASAPContactId,o=$("#contacts").dataTable().fnAddData([u,f,'<a class="delete" href="">Delete<\/a>']),s=$("#contacts").dataTable().fnSettings().aoData[o[0]].nTr;s.setAttribute("id",e);t[0].reset()}else alert(n.message)},error:function(){alert("Server is not responding. Please reload page and try again")}})})}function restoreRow(n,t){for(var r=n.fnGetData(t),u=$(">td",t),i=0,f=u.length;i<f;i++)n.fnUpdate(r[i],t,i,!1)}function editRow(n,t){var r=n.fnGetData(t),i=$(">td",t);i[0].innerHTML='<input type="text" size="45" value="'+r[0]+'"/>';i[1].innerHTML='<input type="text" size="3" value="'+r[1]+'"/>';i[3].innerHTML='<a class="edit" href="">Save<\/a> <a class="cancel" href="">Cancel<\/a>'}function saveRow(n,t,i){var r=$("input",t);$.ajax({url:path+"ASAPHotlineAdmin/EditRowNameOrder",dataType:"json",cache:!1,type:"POST",data:{rowId:i,description:r[0].value,order:r[1].value},success:function(i){i.Success&&(n.fnUpdate(r[0].value,t,0,!1),n.fnUpdate(r[1].value,t,1,!1),n.fnUpdate('<a class="edit" href="">Edit<\/a>',t,3,!1))},error:function(){alert("Server is not responding. Please reload page and try again")}})}$(document).ready(function(){$("#tabs").tabs();initCommunities();initComplaints();initContacts();$("#SaveLookback").submit(function(){return $.ajax({type:"POST",url:$(this).attr("action"),data:$(this).serialize()}),!1});$("#SaveLookback").validate({rules:{LookbackDays:{required:!0,number:!0}}});$("#tabs").tabs({activate:function(n,t){var r=t.newPanel.find(".dataTable").filter(function(){return this.id!=""}),u;for(i=0;i<r.length;i++)u=$("#"+r[i].id).dataTable(),u.fnAdjustColumnSizing()}})});$(document).ajaxSend(function(){ShowProgress()});$(document).ajaxComplete(function(){HideProgress()});