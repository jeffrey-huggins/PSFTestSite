function initSidebar(){$("#listing").html("");$("#title").text("Employee Infection Control");$(".instruction").show();$("#editForm").html("");$("#Residents").val("")}function updateTable(){var r=$("#occurredRangeFrom").val(),u=checkDate(r),t,i,n,f;if(u=="invalid")return alert("Error: Please enter a valid From Date (mm/dd/yyyy)"),!1;if(u=="infuture")return alert("Error: You can not have a From date that is in the future"),!1;if(t=$("#occuredRangeTo").val(),i=checkDate(t),i=="invalid")return alert("Error: Please enter a valid To Date (mm/dd/yyyy)"),!1;if(i=="infuture")return alert("Error: You can not have a To date that is in the future"),!1;n=$("#Residents option:selected").val();n!="0"&&n!=""&&(f=path+"EmployeeInfectionControl/EmployeeInfo?employeeId="+n,$("#selectedEmployeeView").load(f,function(){$("#title").text("Employee Vaccinations for "+$("#residentName").text())}),$("#editForm").load(path+"EmployeeInfectionControl/EditOrCreateInfection?employeeId="+n,loadEditForm),$("#listing").load(path+"EmployeeInfectionControl/GetInfectionList?employeeId="+n+"&fromString="+encodeURIComponent(r)+"&toString="+encodeURIComponent(t),function(){$("#infectionTable").dataTable({bFilter:!1,bAutoWidth:!1,aaSorting:[[1,"desc"]],sDom:"frtS",iDisplayLength:-1});$("#infectionTable").on("click",".edit",function(n){n.preventDefault();$("#editForm").load(this.href,loadEditForm)});$("#infectionTable").on("click",".delete",function(n){n.preventDefault();var t=this.href;$.ajax({url:t,success:function(n){n.Success?updateTable():alert(n.data)},error:function(){alert("Server is not responding. Please reload page and try again")}})})}))}function loadEditForm(){var n=$("#Residents option:selected").val(),t=$("#EmployeeIFCEventId").val();t=="0"&&($("#OnsetDate").val(""),$("#MissedWorkDaysCnt").val(""));$(".isDate").datepicker();$("#saveInfectionForm").on("click",function(n){n.preventDefault();var t=$("#SaveInfection");t.valid()&&t.ajaxSubmit({success:function(n){n.success?updateTable():alert("Error: Event not found in database")},error:function(){alert("Server is not responding. Please reload page and try again")}})});$("#clearInfectionForm").on("click",function(t){t.preventDefault();$("#editForm").load(path+"EmployeeInfectionControl/EditOrCreateInfection?employeeId="+n,loadEditForm)});$.validator.setDefaults({ignore:[]});$("#SaveInfection").removeData("validator");$("#SaveInfection").removeData("unobtrusiveValidation");$.validator.unobtrusive.parse($("#SaveInfection"));$("#SaveInfection").validate()}$("#sideBar").on("change","#Residents",function(){$("#Residents").val()!=""&&$("#Residents").val()!="0"?($(".instruction").hide(),updateTable()):($(".instruction").show(),$("#listing").html(""))});$("#sideBar").on("change","#ShowTerminatedEmplyees",function(){$(this).is(":checked")||(ShowProgress(),$("#SideDDL").ajaxSubmit({url:path+"EmployeeInfectionControl/UpdateEmployeeSideBar",type:"POST",success:function(n){$("#sideBar").html(n);initSidebar()}}))});$("#sideBar").on("click","#lookbackUpdate",function(n){n.preventDefault();$("#Residents").val("");var i=getMomentDate($("#LookbackDate").val()),t=checkDate($("#LookbackDate").val());t=="invalid"?alert("Error: Please enter a valid Last Census Date (mm/dd/yyyy)"):t=="infuture"?alert("Error: You can not have a Census date that is in the future"):(ShowProgress(),$("#SideDDL").ajaxSubmit({url:path+"Vaccination/UpdateEmployeeSideBar",type:"POST",success:function(n){$("#sideBar").html(n);initSidebar()}}))});$("#sideBar").on("change","#Communities",function(){ShowProgress();$("#SideDDL").ajaxSubmit({url:path+"Vaccination/UpdateEmployeeSideBar",type:"POST",success:function(n){$("#sideBar").html(n);initSidebar()}})});$(".isDate").datepicker();$("#updateTable").on("click",updateTable);