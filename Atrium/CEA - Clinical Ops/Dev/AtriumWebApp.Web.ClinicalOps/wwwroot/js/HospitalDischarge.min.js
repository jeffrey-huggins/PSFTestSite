$(document).ready(function(){function i(n,t){for(var r=n.fnGetData(t),u=$(">td",t),i=0,f=u.length+1;i<f;i++)n.fnUpdate(r[i],t,i,!1)}function r(n,t){var v=n.fnGetData(t),i=$(">td",t),y=v[5]=="Yes",r,o,s,u,h,c,e,f,l,a;i[4].innerHTML='<input type="checkbox" id="editPlanned" />';$("#editPlanned").prop("checked",y);r='<select id="editERDischarge">';r=r+$("#ERDischargeReasons").html().toString();$(".ERDischargeReasonIsIncluded",i[5]).val().toLowerCase()==="false"&&(o=$(".ERDischargeReason",i[5]).text().trim(),s=$(".ERDischargeReasonId",i[5]).val(),r=r+'<option value="'+s+'">'+o+"<\/option>");r=r+"<\/select>";$(".ERDischargeReason",i[5]).hide();$(".EditERDischargeReason",i[5]).html(r);$("#editERDischarge").val($(".ERDischargeReasonId",i[5]).val());u='<select id="editHDischarge">';u=u+$("#HospitalDischargeReasons").html().toString();$(".HospitalDischargeReasonIsIncluded",i[5]).val().toLowerCase()==="false"&&(h=$(".HospitalDischargeReason",i[5]).text().trim(),c=$(".HospitalDischargeReasonId",i[5]).val(),u=u+'<option value="'+c+'">'+h+"<\/option>");u=u+"<\/select>";$(".HospitalDischargeReason",i[5]).hide();$(".EditHospitalDischargeReason",i[5]).html(u);$("#editHDischarge").val($(".HospitalDischargeReasonId",i[5]).val());e='<select id="editDNReturn">';e=e+$("#DidNotReturnReasons").html().toString();e=e+"<\/select>";$(".DidNotReturnReason",i[6]).hide();$(".EditDidNotReturnReason",i[6]).html(e);$("#editDNReturn").val($(".DidNotReturnReasonId",i[6]).val());f='<select id="editHospital">';f=f+$("#Hospitals").html().toString();$(".HospitalIsIncluded",i[6]).val().toLowerCase()==="false"&&(l=$(".Hospital",i[6]).text().trim(),a=$(".HospitalId",i[6]).val(),f=f+'<option value="'+a+'">'+l+"<\/option>");f=f+"<\/select>";$(".Hospital",i[6]).hide();$(".EditHospital",i[6]).html(f);$("#editHospital").val($(".HospitalId",i[6]).val());$(".HospitalDischargeReasonId",i[5]).val()==="-2"?$("#editDNReturn").removeAttr("disabled"):($("#editDNReturn").attr("disabled","disabled"),$("#editDNReturn").val("-1"));$("#editHDischarge").change(function(){var n=$("#editHDischarge").val();n==="-2"?$("#editDNReturn").removeAttr("disabled"):($("#editDNReturn").attr("disabled","disabled"),$("#editDNReturn").val("-1"))});i[7].innerHTML='<a class="edit" href="">Save<\/a> <a class="cancel" href="">Cancel<\/a>'}function u(n,t,r){var u={rowId:r,cDate:n.fnGetData(t)[2],Planned:$("#editPlanned",t).is(":checked"),ERDischarge:$("#editERDischarge",t).val(),HDischarge:$("#editHDischarge",t).val(),Hospital:$("#editHospital",t).val(),DNRReason:$("#editDNReturn",t).val()};return $.ajax({url:path+"HospitalDischarge/EditRow",dataType:"json",cache:!1,type:"POST",data:u,success:function(r){r.Success?($(".ERDischargeReasonId",t).val(u.ERDischarge),$(".ERDischargeReason",t).text(r.ERReason).show(),$(".EditERDischargeReason",t).html(""),$(".HospitalDischargeReasonId",t).val(u.HDischarge),$(".HospitalDischargeReason",t).text(r.HDReason).show(),$(".EditHospitalDischargeReason",t).html(""),n.fnUpdate($(".Diagnosis",t).html(),t,6,!1),$(".HospitalId",t).val(u.Hospital),$(".Hospital",t).text(r.Hospital).show(),$(".EditHospital",t).html(""),$(".DidNotReturnReasonId",t).val(u.DNRReason),$(".DidNotReturnReason",t).text(r.DNRReason).show(),$(".EditDidNotReturnReason",t).html(""),n.fnUpdate($(".AdditionalInfo",t).html(),t,7,!1),n.fnUpdate(u.Planned?"Yes":"No",t,5,!1),n.fnUpdate('<a class="edit" href="">Edit<\/a>',t,8,!1)):r.Reason==1?(alert("Error: Event not found in database"),i(n,t)):r.Reason==0&&(alert("Error: Unsuccessful save to the database"),i(n,t))},error:function(){alert("Server is not responding. Please reload the page and try again")}}),!0}var t=$("#HDwindow-table").dataTable({bFilter:!1,bAutoWidth:!1,sScrollY:"400px",sDom:"frtS",iDisplayLength:-1,aoColumns:[{sWidth:"70px"},{sWidth:"25px"},{sWidth:"50px"},{bVisible:!1},{sWidth:"50px"},{sWidth:"10px"},{bSearchable:!1,bSortable:!1,sWidth:"120px"},{bSearchable:!1,bSortable:!1,sWidth:"120px"},{bSearchable:!1,bSortable:!1,sWidth:"40px"}],oLanguage:{sEmptyTable:"No entries for date range selected"}}),n=null;t.fnSort([[2,"desc"]]);t.fnAdjustColumnSizing();$("#HDwindow-table_length").css("display","none");$("#HDwindow-table").on("click","a.edit",function(f){var e,o,s;f.preventDefault();e=$(this).parents("tr")[0];o=$(this).closest("tr").attr("id");n!==null&&n!=e?(i(t,n),r(t,e,o),n=e):n==e&&this.innerHTML=="Save"?(s=u(t,n,o),s&&(n=null)):(r(t,e,o),n=e)});$("#HDwindow-table").on("click","a.cancel",function(n){n.preventDefault();var r=$(this).parents("tr")[0];i(t,r)});$("#occurredRangeTo,#occurredRangeFrom").datepicker({beforeShow:function(n,t){t.dpDiv.css({marginTop:"5px",marginLeft:"0px"})}});$(function(){$("#ToDateRangeInvalid").val()=="1"&&alert('Error: Please enter a valid date in the Discharge Date Range "To" Field (mm/dd/yyyy)');$("#FromDateRangeInvalid").val()=="1"&&alert('Error: Please enter a valid date in the Discharge Date Range "From" Field (mm/dd/yyyy)');$("#ToDateRangeInFuture").val()=="1"&&alert('Error: Please enter a valid date that is not in the future in the Discharge Date Range "To" Field');$("#FromDateRangeInFuture").val()=="1"&&alert('Error: Please enter a valid date that is not in the future in the Discharge Date Range "From" Field');$("#FromAfterTo").val()=="1"&&alert('Error: You can not have the "From" Date after the "To" Date in the Discharge Date Range Fields')})});