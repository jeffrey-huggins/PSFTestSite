function initDischarge(){var n=$("#DischargeReasons").dataTable({bFilter:!1,bAutoWidth:!1,sScrollY:"200px",sDom:"frtS",iDisplayLength:-1,oLanguage:{sEmptyTable:"No Discharge Reasons"}}),t;n.fnSort([[1,"asc"]]);t=null;$("#DischargeReasons").on("click",".EnableDisable",function(){var t=$(this),r=t.parents("tr")[0],u=n.fnGetData(r),i=t.is(":checked"),f=t.hasClass("ER")?0:1;$.ajax({url:path+"JSON/ChangeDataFlg",dataType:"json",cache:!1,type:"POST",data:{description:u[0],dFlag:i,appCode:"HOD",hodCode:f},success:function(n){n.Success||(t.prop("checked",!i),alert("Discharge has failed to be enabled/disabled. Please try again and if you see this message repeatedly the server may be down."))}})});$("#DischargeReasons").on("click",".ReportFlg",function(){var t=$(this),i=t.is(":checked"),r=t.parents("tr")[0],u=n.fnGetData(r);$.ajax({url:path+"JSON/ChangeDataFlgReport",dataType:"json",cache:!1,type:"POST",data:{description:u[0],dFlag:i,appCode:"HOD",hodCode:dischargeContextId},success:function(n){n.Success||(t.prop("checked",!i),alert("Discharge has failed to be enabled/disabled. Please try again and if you see this message repeatedly the server may be down."))}})});$("#DischargeReasons").on("click",".TopN",function(){var t=$(this),i=t.is(":checked"),r=t.parents("tr")[0],u=n.fnGetData(r);$.ajax({url:path+"JSON/ChangeDataFlgTopN",dataType:"json",cache:!1,type:"POST",data:{description:u[0],dFlag:i},success:function(n){n.Success||(t.prop("checked",!i),alert("Discharge has failed to be enabled/disabled. Please try again and if you see this message repeatedly the server may be down."))}})});$("#DischargeReasons").on("click","a.edit",function(i){var r,u,f;i.preventDefault();r=$(this).parents("tr")[0];t!==null&&t!=r?(restoreRow(n,t),editRow(n,r),t=r):t==r&&this.innerHTML=="Save"?(u=$(this).closest("tr").attr("id"),f=saveRowDischarge(n,t,u,dischargeContextId),f&&(t=null)):(editRow(n,r),t=r)});$("#DischargeReasons").on("click","a.cancel",function(t){t.preventDefault();var i=$(this).parents("tr")[0];restoreRow(n,i)});$("#DischargeReasons").on("click"," a.delete",function(t){t.preventDefault();var i=$(this).parents("tr")[0],r=$(this).closest("tr").attr("id"),f=n.fnGetData(i),u=confirm("Are you sure you want to delete?");u&&$.ajax({url:path+"JSON/DeleteRowAdmin",dataType:"json",cache:!1,type:"POST",data:{rowId:r,appCode:"HOD",hodCode:dischargeContextId},success:function(t){t.Success?n.fnDeleteRow(i):alert("Discharge has failed to be deleted. Please try again and if you see this message repeatedly the server may be down.")}})});$("#Discharge").find("[type='submit']").click(function(n){n.preventDefault();var t=$("#Discharge form"),i=$("#NewDischarge_DischargeReasonDesc").val();if(alreadyExist(i,$("#DischargeReasons").dataTable()))return alert("Discharge Reason already exists"),!1;if(!t.valid())return!1;$.ajax({url:t.attr("action"),dataType:"json",type:"POST",data:t.serialize(),success:function(n){if(n.Success){var i=n.data.DischargeReasonDesc,r=n.data.SortOrder,u=n.data.ERDataEntryFlg,f=n.data.HospitalDataEntryFlg,e=n.data.ReportFlg,o=n.data.Top_N,s=n.data.DischargeReasonId,h=$("#DischargeReasons").dataTable().fnAddData([i,r,createCheckboxString("EREnableDisable","EnableDisable ER","EREnableDisable",u),createCheckboxString("HospitalEnableDisable","EnableDisable Hospital","HospitalEnableDisable",f),createCheckboxString("ReportFlg","ReportFlg","ReportFlg",e),createCheckboxString("TopN","TopN","TopN",o),'<a class="edit" href="">Edit<\/a>',""]),c=$("#DischargeReasons").dataTable().fnSettings().aoData[h[0]].nTr;c.setAttribute("id",s);t[0].reset()}else alert(n.message)},error:function(){alert("Server is not responding. Please reload page and try again")}})})}function initDidNotReturnReasons(){var n=$("#DidNotReturnReasons").dataTable({bFilter:!1,bAutoWidth:!1,sScrollY:"200px",bScrollCollapse:!0,sDom:"frtS",iDisplayLength:-1,aoColumns:[{sWidth:"400px"},null,{bSortable:!1},{bSortable:!1},{bSortable:!1}],oLanguage:{sEmptyTable:"No Did Not Return Reasons"}}),t;n.fnSort([[1,"asc"]]);t=null;$("#DidNotReturnReasons").on("click",".EnableDisable",function(){var t=$(this),i=t.is(":checked"),r=t.parents("tr")[0],u=n.fnGetData(r);$.ajax({url:path+"JSON/ChangeDataFlg",dataType:"json",cache:!1,type:"POST",data:{description:u[0],dFlag:i,appCode:"HOD",hodCode:dnrrContextId},success:function(n){n.Success||(t.prop("checked",!i),alert("Did Not Return Reason has failed to be enabled/disabled. Please try again and if you see this message repeatedly the server may be down."))}})});$("#DidNotReturnReasons").on("click","a.delete",function(t){t.preventDefault();var i=$(this).parents("tr")[0],r=$(this).closest("tr").attr("id"),f=n.fnGetData(i),u=confirm("Are you sure you want to delete?");u&&$.ajax({url:path+"JSON/DeleteRowAdmin",dataType:"json",cache:!1,type:"POST",data:{rowId:r,appCode:"HOD",hodCode:dnrrContextId},success:function(t){t.Success?n.fnDeleteRow(i):alert("Did Not Return Reason has failed to be deleted. Please try again and if you see this message repeatedly the server may be down.")}})});$("#DidNotReturnReasons").on("click","a.edit",function(i){var r,u,f;i.preventDefault();r=$(this).parents("tr")[0];t!==null&&t!=r?(restoreRow(n,t),editRowDNRR(n,r),t=r):t==r&&this.innerHTML=="Save"?(u=$(this).closest("tr").attr("id"),f=saveRowDNRR(n,t,u,dnrrContextId),f&&(t=null)):(editRowDNRR(n,r),t=r)});$("#DidNotReturnReasons").on("click","a.cancel",function(t){t.preventDefault();var i=$(this).parents("tr")[0];restoreRow(n,i)});$("#Return").find("[type='submit']").click(function(n){n.preventDefault();var t=$("#Return form"),i=$("#NewDNRR_DidNotReturnReasonDesc").val();if(alreadyExist(i,$("#DidNotReturnReasons").dataTable()))return alert("Did Not Return Reason already exists"),!1;if(!t.valid())return!1;$.ajax({url:t.attr("action"),dataType:"json",type:"POST",data:t.serialize(),success:function(n){if(n.Success){var i=n.data.DidNotReturnReasonDesc,r=n.data.SortOrder,u=n.data.DataEntryFlg,f=n.data.DidNotReturnReasonId,e=$("#DidNotReturnReasons").dataTable().fnAddData([i,r,createCheckboxString("EnableDisable","EnableDisable","EnableDisable",u),'<a class="edit" href="">Edit<\/a>',""]),o=$("#DidNotReturnReasons").dataTable().fnSettings().aoData[e[0]].nTr;o.setAttribute("id",f);t[0].reset()}else alert(n.message)},error:function(){alert("Server is not responding. Please reload page and try again")}})})}function initCommunity(){var i=$("#CommunityTable").dataTable({bFilter:!1,bAutoWidth:!1,sScrollY:"600px",sDom:"frtS",iDisplayLength:-1,oLanguage:{sEmptyTable:"No Law Firms"}}),n,t;$(".checkbox").click(function(){var n=$(this),t=n.is(":checked"),i=n.attr("id"),r=n.parents("tr").children(":first-child").text();$.ajax({url:path+"Base/ChangeDataFlgCom",dataType:"json",cache:!1,type:"POST",data:{community:i,dFlag:t,appCode:"HOD"},success:function(i){i.Success||(n.prop("checked",!t),alert("Community has failed to be enabled/disabled. Please try again and if you see this message repeatedly the server may be down."))}})});$(".checkboxReport").click(function(){var n=$(this),t=n.is(":checked"),i=n.attr("id"),r=n.parents("tr").children(":first-child").text();$.ajax({url:path+"Base/ChangeReportFlgCom",dataType:"json",cache:!1,type:"POST",data:{community:i,dFlag:t,appCode:"HOD"},success:function(i){i.Success||(n.prop("checked",!t),alert("Community report flag has failed to be enabled/disabled. Please try again and if you see this message repeatedly the server may be down."))}})});$(".checkboxPayer").click(function(){var n=$(this),t=n.is(":checked"),i=n.attr("id"),u=n.parents("tr").children(":first-child").text(),r=n.closest("tr").attr("id");$.ajax({url:path+"Base/ChangePayerIncludeFlg",dataType:"json",cache:!1,type:"POST",data:{community:r,dFlag:t,appCode:"HOD",payer:i},success:function(i){i.Success||(n.prop("checked",!t),alert("Community report flag has failed to be enabled/disabled. Please try again and if you see this message repeatedly the server may be down."))}})});$("#SaveLookback").validate({rules:{LookbackDays:{required:!0,number:!0}}});n=$("#hospitalAssociationModal");$(".select-hospitals").on("click",function(i){i.preventDefault();$.ajax({url:this.href,success:function(i){var r=$("<div />"),u,f;r.addClass("modal");$("body").append(r);n.html(i);n.show();u=Math.max($(window).height()/2-n[0].offsetHeight/2,0);f=Math.max($(window).width()/2-n[0].offsetWidth/2,0);n.css({top:u,left:f});t=$("#selectedHospitals",n).dataTable({bFilter:!1,bAutoWidth:!1,sScrollY:"370px",sDom:"frtS",iDisplayLength:-1,aoColumns:[{sWidth:"500px"},{sWidth:"100px",bSortable:!1}],oLanguage:{sEmptyTable:"No Hospitals"}})},error:function(){alert("Could not communicate with the server.")}})});n.on("click","#close",function(){$(".modal").hide();n.hide()});n.on("change",".selectHospital",function(){var i=$(this),n=$(this).is(":checked"),r=$(this).parents("tr")[0],u=$(this).closest("tr").attr("id"),e=t.fnGetData(r),f=$("#CommunityId").val();$.ajax({url:path+"HospitalDischargeAdmin/ChangeHospitalAssociation",dataType:"json",cache:!1,type:"POST",data:{hospitalId:u,communityId:f,isAssociated:n},success:function(t){t.Success||(i.prop("checked",!n),alert("Hospital has failed to be associated. Please try again and if you see this message repeatedly the server may be down."))},error:function(){alert("Error communicating with server.")}})})}function initHospitals(){var n=$("#Hospitals").dataTable({bFilter:!1,bAutoWidth:!1,sScrollY:"200px",bScrollCollapse:!0,sDom:"frtS",iDisplayLength:-1,aoColumns:[{sWidth:"400px"},null,{bSortable:!1},{bSortable:!1},{bSortable:!1},{bSortable:!1}],oLanguage:{sEmptyTable:"No Hospitals"}}),t;n.fnSort([[1,"asc"]]);t=null;$("#Hospitals").on("click",".EnableDisable",function(){var t=$(this),i=t.is(":checked"),r=t.parents("tr")[0],u=n.fnGetData(r);$.ajax({url:path+"JSON/ChangeDataFlg",dataType:"json",cache:!1,type:"POST",data:{description:u[0],dFlag:i,appCode:"HOD",hodCode:hospitalContextId},success:function(n){n.Success||(t.prop("checked",!i),alert("Hospital has failed to be enabled/disabled. Please try again and if you see this message repeatedly the server may be down."))}})});$("#Hospitals").on("click",".ReportFlg",function(){var t=$(this),i=t.is(":checked"),r=t.parents("tr")[0],u=n.fnGetData(r);$.ajax({url:path+"JSON/ChangeDataFlgReport",dataType:"json",cache:!1,type:"POST",data:{description:u[0],dFlag:i,appCode:"HOD",hodCode:hospitalContextId},success:function(n){n.Success||(t.prop("checked",!i),alert("Hospital has failed to be enabled/disabled. Please try again and if you see this message repeatedly the server may be down."))}})});$("#Hospitals").on("click","a.edit",function(i){var r,u,f;i.preventDefault();r=$(this).parents("tr")[0];t!==null&&t!=r?(restoreRow(n,t),editRowHospital(n,r),t=r):t==r&&this.innerHTML=="Save"?(u=$(this).closest("tr").attr("id"),f=saveRowHospital(n,t,u,hospitalContextId),f&&(t=null)):(editRowHospital(n,r),t=r)});$("#Hospitals").on("click","a.cancel",function(t){t.preventDefault();var i=$(this).parents("tr")[0];restoreRow(n,i)});$("#Hospitals").on("click","a.delete",function(t){t.preventDefault();var i=$(this).parents("tr")[0],r=$(this).closest("tr").attr("id"),f=n.fnGetData(i),u=confirm("Are you sure you want to delete?");u&&$.ajax({url:path+"JSON/DeleteRowAdmin",dataType:"json",cache:!1,type:"POST",data:{rowId:r,appCode:"HOD",hodCode:hospitalContextId},success:function(t){t.Success?n.fnDeleteRow(i):alert("Hospital has failed to be deleted. Please try again and if you see this message repeatedly the server may be down.")}})});$("#Hospital").find("[type='submit']").click(function(n){n.preventDefault();var t=$("#Hospital form"),i=$("#NewDNRR_DidNotReturnReasonDesc").val();if(alreadyExist(i,$("#Hospitals").dataTable()))return alert("Did Not Return Reason already exists"),!1;if(!t.valid())return!1;$.ajax({url:t.attr("action"),dataType:"json",type:"POST",data:t.serialize(),success:function(n){if(n.Success){var i=n.data.Name,r=n.data.SortOrder,u=n.data.AllowDataEntry,f=n.data.AllowReporting,e=n.data.DidNotReturnReasonId,o=$("#Hospitals").dataTable().fnAddData([i,r,createCheckboxString("EnableDisable","EnableDisable","EnableDisable",u),createCheckboxString("EnableDisable","ReportFlg","EnableDisable",f),'<a class="edit" href="">Edit<\/a>',""]),s=$("#Hospitals").dataTable().fnSettings().aoData[o[0]].nTr;s.setAttribute("id",e);t[0].reset()}else alert(n.message)},error:function(){alert("Server is not responding. Please reload page and try again")}})})}function alreadyExist(n,t,i){var u,r,f;for(i||(i=0),u=t.dataTable().fnGetData(),r=0;r<u.length;r++)if(f=u[r][i],f.toLowerCase()===n.toLowerCase())return!0;return!1}function restoreRow(n,t){for(var r=n.fnGetData(t),u=$(">td",t),i=0,f=u.length;i<f;i++)n.fnUpdate(r[i],t,i,!1)}function editRow(n,t){var r=n.fnGetData(t),i=$(">td",t);i[0].innerHTML='<input type="text" value="'+r[0]+'"/>';i[1].innerHTML='<input type="text" value="'+r[1]+'"/>';i[6].innerHTML='<a class="edit" href="">Save<\/a> <a class="cancel" href="">Cancel<\/a>'}function saveRowDischarge(n,t,i,r){var u=$("input",t);return $.ajax({url:path+"JSON/EditRowNameOrder",dataType:"json",cache:!1,type:"POST",data:{rowId:i,description:u[0].value,order:u[1].value,appCode:"HOD",hodCode:r},success:function(i){i.Success&&(n.fnUpdate(u[0].value,t,0,!1),n.fnUpdate(u[1].value,t,1,!1),n.fnUpdate('<a class="edit" href="">Edit<\/a>',t,6,!1))},error:function(){alert("Server is not responding. Please reload page and try again")}}),!0}function editRowDNRR(n,t){var r=n.fnGetData(t),i=$(">td",t);i[0].innerHTML='<input type="text" value="'+r[0]+'"/>';i[1].innerHTML='<input type="text" value="'+r[1]+'"/>';i[3].innerHTML='<a class="edit" href="">Save<\/a> <a class="cancel" href="">Cancel<\/a>'}function saveRowDNRR(n,t,i,r){var u=$("input",t);return $.ajax({url:path+"JSON/EditRowNameOrder",dataType:"json",cache:!1,type:"POST",data:{rowId:i,description:u[0].value,order:u[1].value,appCode:"HOD",hodCode:r},success:function(i){i.Success&&(n.fnUpdate(u[0].value,t,0,!1),n.fnUpdate(u[1].value,t,1,!1),n.fnUpdate('<a class="edit" href="">Edit<\/a>',t,3,!1))},error:function(){alert("Server is not responding. Please reload page and try again")}}),!0}function editRowHospital(n,t){var r=n.fnGetData(t),i=$(">td",t);i[0].innerHTML='<input type="text" value="'+r[0]+'"/>';i[1].innerHTML='<input type="text" value="'+r[1]+'"/>';i[4].innerHTML='<a class="edit" href="">Save<\/a> <a class="cancel" href="">Cancel<\/a>'}function saveRowHospital(n,t,i,r){var u=$("input",t);return $.ajax({url:path+"JSON/EditRowNameOrder",dataType:"json",cache:!1,type:"POST",data:{rowId:i,description:u[0].value,order:u[1].value,appCode:"HOD",hodCode:r},success:function(i){i.Success&&(n.fnUpdate(u[0].value,t,0,!1),n.fnUpdate(u[1].value,t,1,!1),n.fnUpdate('<a class="edit" href="">Edit<\/a>',t,4,!1))},error:function(){alert("Server is not responding. Please reload page and try again")}}),!0}function createCheckboxString(n,t,i,r){var u,f;return r&&(u="checked"),f='<input class="'+t+'" id="'+n+'" name="'+i+'" type="checkbox" value="'+r+'" '+u+">",f+('<input name="'+i+'" type="hidden" value="'+r+'">')}var dischargeContextId=0,dnrrContextId=2,hospitalContextId=3;$(document).ready(function(){$("#tabs").tabs();initDischarge();initDidNotReturnReasons();initHospitals();initCommunity();$("#tabs").tabs({activate:function(n,t){var r=t.newPanel.find(".dataTable").filter(function(){return this.id!=""}),u;for(i=0;i<r.length;i++)u=$("#"+r[i].id).dataTable(),u.fnAdjustColumnSizing()}})});$(document).ajaxSend(function(){ShowProgress()});$(document).ajaxComplete(function(){HideProgress()});