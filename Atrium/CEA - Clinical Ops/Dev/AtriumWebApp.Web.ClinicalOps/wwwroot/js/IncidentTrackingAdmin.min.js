function initIncident(){var n=$("#IncidentTypes").dataTable({bFilter:!1,bAutoWidth:!1,sScrollY:"200px",sDom:"frtS",iDisplayLength:-1,oLanguage:{sEmptyTable:"No Incident Types"}}),t;n.fnSort([[1,"asc"]]);t=null;$("#IncidentTypes").on("click",".EnableDisable",function(){var t=$(this),i=$(this).is(":checked"),r=$(this).parents("tr")[0],u=n.fnGetData(r);$.ajax({url:path+"JSON/ChangeDataFlg",dataType:"json",cache:!1,type:"POST",data:{description:u[0],dFlag:i,appCode:"ITR",itrCode:incidentContextId},success:function(n){n.Success||(t.prop("checked",!checked),alert("Incident has failed to be enabled/disabled. Please try again and if you see this message repeatedly the server may be down."))}})});$("#IncidentTypes").on("click","a.delete",function(t){t.preventDefault();var i=$(this).parents("tr")[0],r=$(this).closest("tr").attr("id"),f=n.fnGetData(i),u=confirm("Are you sure you want to delete?");u&&$.ajax({url:path+"JSON/DeleteRowAdmin",dataType:"json",cache:!1,type:"POST",data:{rowId:r,appCode:"ITR",itrCode:incidentContextId},success:function(t){t.Success?n.fnDeleteRow(i):alert("Incident has failed to be deleted. Please try again and if you see this message repeatedly the server may be down.")}})});$("#IncidentTypes").on("click","a.edit",function(i){var r,u,f;i.preventDefault();r=$(this).parents("tr")[0];t!==null&&t!=r?(restoreRow(n,t),editRow(n,r),t=r):t==r&&this.innerHTML=="Save"?(u=$(this).closest("tr").attr("id"),f=saveRowIncident(n,t,u),f&&(t=null)):(editRow(n,r),t=r)});$("#IncidentTypes").on("click","a.cancel",function(t){t.preventDefault();var i=$(this).parents("tr")[0];restoreRow(n,i)});$("#admin-body").on("click",".ReportFlg",function(){var t=$(this),i=$(this).is(":checked"),r=$(this).parents("tr")[0],u=n.fnGetData(r);$.ajax({url:path+"JSON/ChangeDataFlgReport",dataType:"json",cache:!1,type:"POST",data:{description:u[0],dFlag:i,appCode:"ITR"},success:function(n){n.Success||(t.prop("checked",!checked),alert("Incident has failed to be enabled/disabled. Please try again and if you see this message repeatedly the server may be down."))}})});$("#incidentsTab").find("[type='submit']").click(function(n){n.preventDefault();var t=$("#incidentsTab form"),i=$("#NewIncidentType_PatientIncidentName").val();if(alreadyExist(i,$("#IncidentTypes").dataTable()))return alert("Incident type already exists"),!1;if(!t.valid())return!1;$.ajax({url:t.attr("action"),dataType:"json",type:"POST",data:t.serialize(),success:function(n){if(n.Success){var i=n.data.PatientIncidentName,r=n.data.SortOrder,u=n.data.DataEntryFlg,f=n.data.ReportFlg,e=n.data.PatientIncidentTypeId,o=$("#IncidentTypes").dataTable().fnAddData([i,r,createCheckboxString("EnableDisable","EnableDisable","EnableDisable",u),createCheckboxString("ReportFlg","ReportFlg","ReportFlg",f),'<a class="edit" href="">Edit<\/a>','<a class="delete" href="">Delete<\/a>']),s=$("#IncidentTypes").dataTable().fnSettings().aoData[o[0]].nTr;s.setAttribute("id",e);t[0].reset()}else alert(n.message)},error:function(){alert("Server is not responding. Please reload page and try again")}})})}function initLocations(){var n=$("#location").dataTable({bFilter:!1,bAutoWidth:!1,sScrollY:"200px",sDom:"frtS",iDisplayLength:-1,oLanguage:{sEmptyTable:"No Locations"}}),t;n.fnSort([[1,"asc"]]);t=null;$("#location").on("click",".EnableDisable",function(){var t=$(this),i=$(this).is(":checked"),r=$(this).parents("tr")[0],u=n.fnGetData(r);$.ajax({url:path+"JSON/ChangeDataFlg",dataType:"json",cache:!1,type:"POST",data:{description:u[0],dFlag:i,appCode:"ITR",itrCode:locationContextId},success:function(n){n.Success||(t.prop("checked",!checked),alert("Location has failed to be enabled/disabled. Please try again and if you see this message repeatedly the server may be down."))}})});$("#location").on("click","a.delete",function(t){t.preventDefault();var i=$(this).parents("tr")[0],r=$(this).closest("tr").attr("id"),f=n.fnGetData(i),u=confirm("Are you sure you want to delete?");u&&$.ajax({url:path+"JSON/DeleteRowAdmin",dataType:"json",cache:!1,type:"POST",data:{rowId:r,appCode:"ITR",itrCode:locationContextId},success:function(t){t.Success?n.fnDeleteRow(i):alert("Location has failed to be deleted. Please try again and if you see this message repeatedly the server may be down.")}})});$("#location").on("click","a.edit",function(i){var r,u,f;i.preventDefault();r=$(this).parents("tr")[0];t!==null&&t!=r?(restoreRow(n,t),editRowNoReport(n,r),t=r):t==r&&this.innerHTML=="Save"?(u=$(this).closest("tr").attr("id"),f=saveRowLocation(n,t,u),f&&(t=null)):(editRowNoReport(n,r),t=r)});$("#location").on("click","a.cancel",function(t){t.preventDefault();var i=$(this).parents("tr")[0];restoreRow(n,i)});$("#locationTab").find("[type='submit']").click(function(n){n.preventDefault();var t=$("#locationTab form"),i=$("#NewLocation_PatientIncidentLocationName").val();if(alreadyExist(i,$("#location").dataTable()))return alert("Location already exists"),!1;if(!t.valid())return!1;$.ajax({url:t.attr("action"),dataType:"json",type:"POST",data:t.serialize(),success:function(n){if(n.Success){var i=n.data.PatientIncidentLocationName,r=n.data.SortOrder,u=n.data.DataEntryFlg,f=n.data.PatientIncidentLocationId,e=$("#location").dataTable().fnAddData([i,r,createCheckboxString("EnableDisable","EnableDisable","EnableDisable",u),'<a class="edit" href="">Edit<\/a>','<a class="delete" href="">Delete<\/a>']),o=$("#location").dataTable().fnSettings().aoData[e[0]].nTr;o.setAttribute("id",f);t[0].reset()}else alert(n.message)},error:function(){alert("Server is not responding. Please reload page and try again")}})})}function initInterventions(){var n=$("#intervention").dataTable({bFilter:!1,bAutoWidth:!1,sScrollY:"200px",sDom:"frtS",iDisplayLength:-1,oLanguage:{sEmptyTable:"No Intervention Types"}}),t;n.fnSort([[1,"asc"]]);t=null;$("#intervention").on("click",".EnableDisable",function(){var t=$(this),i=$(this).is(":checked"),r=$(this).parents("tr")[0],u=n.fnGetData(r);$.ajax({url:path+"JSON/ChangeDataFlg",dataType:"json",cache:!1,type:"POST",data:{description:u[0],dFlag:i,appCode:"ITR",itrCode:interventionContextId},success:function(n){n.Success||(t.prop("checked",!checked),alert("Intervention has failed to be enabled/disabled. Please try again and if you see this message repeatedly the server may be down."))}})});$("#intervention").on("click","a.delete",function(t){t.preventDefault();var i=$(this).parents("tr")[0],r=$(this).closest("tr").attr("id"),f=n.fnGetData(i),u=confirm("Are you sure you want to delete?");u&&$.ajax({url:path+"JSON/DeleteRowAdmin",dataType:"json",cache:!1,type:"POST",data:{rowId:r,appCode:"ITR",itrCode:interventionContextId},success:function(t){t.Success?n.fnDeleteRow(i):alert("Intervention has failed to be deleted. Please try again and if you see this message repeatedly the server may be down.")}})});$("#intervention").on("click","a.edit",function(i){var r,u,f;i.preventDefault();r=$(this).parents("tr")[0];t!==null&&t!=r?(restoreRow(n,t),editRowNoReport(n,r),t=r):t==r&&this.innerHTML=="Save"?(u=$(this).closest("tr").attr("id"),f=saveRowInter(n,t,u),f&&(t=null)):(editRowNoReport(n,r),t=r)});$("#intervention").on("click","a.cancel",function(t){t.preventDefault();var i=$(this).parents("tr")[0];restoreRow(n,i)});$("#interventionTab").find("[type='submit']").click(function(n){n.preventDefault();var t=$("#interventionTab form"),i=$("#NewIntervention_PatientIncidentInterventionName").val();if(alreadyExist(i,$("#intervention").dataTable()))return alert("Intervention already exists"),!1;if(!t.valid())return!1;$.ajax({url:t.attr("action"),dataType:"json",type:"POST",data:t.serialize(),success:function(n){if(n.Success){var i=n.data.PatientIncidentInterventionName,r=n.data.SortOrder,u=n.data.DataEntryFlg,f=n.data.PatientIncidentInterventionId,e=$("#intervention").dataTable().fnAddData([i,r,createCheckboxString("EnableDisable","EnableDisable","EnableDisable",u),'<a class="edit" href="">Edit<\/a>','<a class="delete" href="">Delete<\/a>']),o=$("#intervention").dataTable().fnSettings().aoData[e[0]].nTr;o.setAttribute("id",f);t[0].reset()}else alert(n.message)},error:function(){alert("Server is not responding. Please reload page and try again")}})})}function initTreatments(){var n=$("#treatment").dataTable({bFilter:!1,bAutoWidth:!1,sScrollY:"200px",sDom:"frtS",iDisplayLength:-1,oLanguage:{sEmptyTable:"No Treatments"}}),t;n.fnSort([[1,"asc"]]);t=null;$("#treatment").on("click",".EnableDisable",function(){var t=$(this),i=$(this).is(":checked"),r=$(this).parents("tr")[0],u=n.fnGetData(r);$.ajax({url:path+"JSON/ChangeDataFlg",dataType:"json",cache:!1,type:"POST",data:{description:u[0],dFlag:i,appCode:"ITR",itrCode:treatmentContextId},success:function(n){n.Success||(t.prop("checked",!checked),alert("Treatment has failed to be enabled/disabled. Please try again and if you see this message repeatedly the server may be down."))}})});$("#treatment").on("click","a.delete",function(t){t.preventDefault();var i=$(this).parents("tr")[0],r=$(this).closest("tr").attr("id"),f=n.fnGetData(i),u=confirm("Are you sure you want to delete?");u&&$.ajax({url:path+"JSON/DeleteRowAdmin",dataType:"json",cache:!1,type:"POST",data:{rowId:r,appCode:"ITR",itrCode:treatmentContextId},success:function(t){t.Success?n.fnDeleteRow(i):alert("Treatment has failed to be deleted. Please try again and if you see this message repeatedly the server may be down.")}})});$("#treatment").on("click","a.edit",function(i){var r,u,f;i.preventDefault();r=$(this).parents("tr")[0];t!==null&&t!=r?(restoreRow(n,t),editRowNoReport(n,r),t=r):t==r&&this.innerHTML=="Save"?(u=$(this).closest("tr").attr("id"),f=saveRowTreat(n,t,u),f&&(t=null)):(editRowNoReport(n,r),t=r)});$("#treatment").on("click","a.cancel",function(t){t.preventDefault();var i=$(this).parents("tr")[0];restoreRow(n,i)});$("#treatmentTab").find("[type='submit']").click(function(n){n.preventDefault();var t=$("#treatmentTab form"),i=$("#NewTreatment_PatientIncidentTreatmentName").val();if(alreadyExist(i,$("#treatment").dataTable()))return alert("Treatment already exists"),!1;if(!t.valid())return!1;$.ajax({url:t.attr("action"),dataType:"json",type:"POST",data:t.serialize(),success:function(n){if(n.Success){var i=n.data.PatientIncidentTreatmentName,r=n.data.SortOrder,u=n.data.DataEntryFlg,f=n.data.PatientIncidentTreatmentId,e=$("#treatment").dataTable().fnAddData([i,r,createCheckboxString("EnableDisable","EnableDisable","EnableDisable",u),'<a class="edit" href="">Edit<\/a>','<a class="delete" href="">Delete<\/a>']),o=$("#treatment").dataTable().fnSettings().aoData[e[0]].nTr;o.setAttribute("id",f);t[0].reset()}else alert(n.message)},error:function(){alert("Server is not responding. Please reload page and try again")}})})}function initCommunities(){for(var t=$("#CommunityTable").dataTable({bFilter:!1,bAutoWidth:!1,sScrollY:"600px",sDom:"frtS",iDisplayLength:-1,oLanguage:{sEmptyTable:"No Communities"}}),i=t.fnSettings().aoColumns,n=0;n<i.length;n++)if(i[n].sTitle=="RegionalNurseEmployeeIds"){regionalNurseId=n;t.fnSetColumnVis(n,!1,!0);break}$(".RegionalNurse").on("click",function(n){var r,i;n.preventDefault();var f=$(this).parents("tr")[0],e=$(this).closest("tr").attr("id"),u=t.fnGetData(f);for($("#CommunityId").val(e),$("#CommunityName").text(u[0]),r=u[regionalNurseId].split("|"),$("#regionalNurses input").prop("checked",!1),i=0;i<r.length;i++)r[i]!=""&&$("#regionalNurses tr#"+r[i].toString()+" input").prop("checked",!0);$("#regionalNurseModal").dialog({width:800,open:function(){$("#regionalNurses").dataTable().fnAdjustColumnSizing()}})})}function initRegionalNurses(){var n=$("#regionalNurses").dataTable({bFilter:!1,bAutoWidth:!1,sScrollY:"400px",sDom:"frtS",iDisplayLength:-1,aoColumns:[null,null,{bSortable:!1}],oLanguage:{sEmptyTable:"No Regional Nurses"}});$(".selectRegionalNurse").click(function(){var r=$(this),t=$(this).is(":checked"),u=$(this).parents("tr")[0],f=$(this).closest("tr").attr("id"),e=n.fnGetData(u),i=$("#CommunityId").val();$.ajax({url:path+"IncidentTrackingAdmin/ChangeRegionalNurse",dataType:"json",cache:!1,type:"POST",data:{nurseId:f,community:i,rFlag:t},success:function(n){if(n.Success){var u=$("#CommunityTable tr#"+i)[0],f=$("#CommunityTable").dataTable();f.fnUpdate(n.Nurses,u,regionalNurseId,!0)}else r.prop("checked",!t),alert("Regional Nurse has failed to be enabled/disabled. Please try again and if you see this message repeatedly the server may be down.")}})})}function initCloseAllEmployees(){var n=$("#CloseAllCommunity").dataTable({bFilter:!1,bAutoWidth:!1,sScrollY:"570px",sDom:"frtS",iDisplayLength:-1,aoColumns:[null,null,{bSortable:!1}],oLanguage:{sEmptyTable:"No Employees"}});$(".selectCloseAllCommunity").click(function(){var i=$(this),t=$(this).is(":checked"),r=$(this).parents("tr")[0],u=$(this).closest("tr").attr("id"),f=n.fnGetData(r);$.ajax({url:path+"IncidentTrackingAdmin/ChangeCloseAll",dataType:"json",cache:!1,type:"POST",data:{employeeId:u,cFlag:t},success:function(n){n.Success||(i.prop("checked",!t),alert("Employee has failed to be enabled/disabled. Please try again and if you see this message repeatedly the server may be down."))}})})}function initSharedEvents(){$(".checkbox").click(function(){var t=$(this),n=$(this).is(":checked"),i=$(this).attr("id"),r=$(this).parents("tr").children(":first-child").text();$.ajax({url:path+"Base/ChangeDataFlgCom",dataType:"json",cache:!1,type:"POST",data:{community:i,dFlag:n,appCode:"ITR"},success:function(i){i.Success||(t.prop("checked",!n),alert("Community has failed to be enabled/disabled. Please try again and if you see this message repeatedly the server may be down."))}})});$(".checkboxReport").click(function(){var t=$(this),n=$(this).is(":checked"),i=$(this).attr("id"),r=$(this).parents("tr").children(":first-child").text();$.ajax({url:path+"Base/ChangeReportFlgCom",dataType:"json",cache:!1,type:"POST",data:{community:i,dFlag:n,appCode:"ITR"},success:function(i){i.Success||(t.prop("checked",!n),alert("Community report flag has failed to be enabled/disabled. Please try again and if you see this message repeatedly the server may be down."))}})});$("#close").click(function(){$(".modal").hide();$("#regionalNurseModal").hide()});$(".checkboxPayer").click(function(){var t=$(this),n=$(this).is(":checked"),i=$(this).attr("id"),u=$(this).parents("tr").children(":first-child").text(),r=$(this).closest("tr").attr("id");$.ajax({url:path+"Base/ChangePayerIncludeFlg",dataType:"json",cache:!1,type:"POST",data:{community:r,dFlag:n,appCode:"ITR",payer:i},success:function(i){i.Success||(t.prop("checked",!n),alert("Community report flag has failed to be enabled/disabled. Please try again and if you see this message repeatedly the server may be down."))}})})}function submitType(){document.getElementById("NewType").submit()}function restoreRow(n,t){for(var r=n.fnGetData(t),u=$(">td",t),i=0,f=u.length;i<f;i++)n.fnUpdate(r[i],t,i,!1)}function editRow(n,t){var r=n.fnGetData(t),i=$(">td",t);i[0].innerHTML='<input type="text" value="'+r[0]+'"/>';i[1].innerHTML='<input type="text" value="'+r[1]+'"/>';i[4].innerHTML='<a class="edit" href="">Save<\/a> <a class="cancel" href="">Cancel<\/a>'}function saveRowIncident(n,t,i){var r=$("input",t);$.ajax({url:path+"JSON/EditRowNameOrder",dataType:"json",cache:!1,type:"POST",data:{rowId:i,description:r[0].value,order:r[1].value,appCode:"ITR",itrCode:incidentContextId},success:function(i){i.Success&&(n.fnUpdate(r[0].value,t,0,!1),n.fnUpdate(r[1].value,t,1,!1),n.fnUpdate('<a class="edit" href="">Edit<\/a>',t,4,!1))},error:function(){alert("Server is not responding. Please reload page and try again")}})}function saveRowLocation(n,t,i){var r=$("input",t);$.ajax({url:path+"JSON/EditRowNameOrder",dataType:"json",cache:!1,type:"POST",data:{rowId:i,description:r[0].value,order:r[1].value,appCode:"ITR",itrCode:locationContextId},success:function(i){i.Success&&(n.fnUpdate(r[0].value,t,0,!1),n.fnUpdate(r[1].value,t,1,!1),n.fnUpdate('<a class="edit" href="">Edit<\/a>',t,3,!1))},error:function(){alert("Server is not responding. Please reload page and try again")}})}function editRowNoReport(n,t){var r=n.fnGetData(t),i=$(">td",t);i[0].innerHTML='<input type="text" value="'+r[0]+'"/>';i[1].innerHTML='<input type="text" size="2" value="'+r[1]+'"/>';i[3].innerHTML='<a class="edit" href="">Save<\/a> <a class="cancel" href="">Cancel<\/a>'}function saveRowInter(n,t,i){var r=$("input",t);$.ajax({url:path+"JSON/EditRowNameOrder",dataType:"json",cache:!1,type:"POST",data:{rowId:i,description:r[0].value,order:r[1].value,appCode:"ITR",itrCode:interventionContextId},success:function(i){i.Success&&(n.fnUpdate(r[0].value,t,0,!1),n.fnUpdate(r[1].value,t,1,!1),n.fnUpdate('<a class="edit" href="">Edit<\/a>',t,3,!1))},error:function(){alert("Server is not responding. Please reload page and try again")}})}function saveRowTreat(n,t,i){var r=$("input",t);$.ajax({url:path+"JSON/EditRowNameOrder",dataType:"json",cache:!1,type:"POST",data:{rowId:i,description:r[0].value,order:r[1].value,appCode:"ITR",itrCode:treatmentContextId},success:function(i){i.Success&&(n.fnUpdate(r[0].value,t,0,!1),n.fnUpdate(r[1].value,t,1,!1),n.fnUpdate('<a class="edit" href="">Edit<\/a>',t,3,!1))},error:function(){alert("Server is not responding. Please reload page and try again")}})}function createCheckboxString(n,t,i,r){var u,f;return r&&(u="checked"),f='<input class="'+t+'" id="'+n+'" name="'+i+'" type="checkbox" value="'+r+'" '+u+">",f+('<input name="'+i+'" type="hidden" value="'+r+'">')}function alreadyExist(n,t,i){var u,r,f;for(i||(i=0),u=t.dataTable().fnGetData(),r=0;r<u.length;r++)if(f=u[r][i],f.toLowerCase()===n.toLowerCase())return!0;return!1}var incidentContextId=0,locationContextId=1,interventionContextId=2,treatmentContextId=3,regionalNurseId;$(document).ready(function(){$("#tabs").tabs();initCommunities();initIncident();initLocations();initInterventions();initTreatments();initRegionalNurses();initCloseAllEmployees();initSharedEvents();$("#SaveLookback").validate({rules:{LookbackDays:{required:!0,number:!0}}});$("#tabs").tabs({activate:function(n,t){var r=t.newPanel.find(".dataTable").filter(function(){return this.id!=""}),u;for(i=0;i<r.length;i++)u=$("#"+r[i].id).dataTable(),u.fnAdjustColumnSizing()}})});$(document).ajaxSend(function(){ShowProgress()});$(document).ajaxComplete(function(){HideProgress()});