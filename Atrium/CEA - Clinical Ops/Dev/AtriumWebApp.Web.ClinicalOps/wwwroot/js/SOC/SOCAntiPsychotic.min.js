function editAntiNote(n){n.preventDefault();$("#note").load(this.href,antipsychoticNoteLoaded)}function copyAntiNote(n){n.preventDefault();$("#note").load(this.href,function(){$("#notedID").val("0");$("#NotedDate").val("");antipsychoticNoteLoaded()})}function deleteAntiNote(n){n.preventDefault();var t=$(this).closest("tr");if($("#antiTable").find("tbody tr").length==1){alert("Cannot delete this row. One Noted Record must remain for each Standards of Care entry.");return}$.ajax({url:this.href,method:"post",success:function(n){n.Success?loadNotesLists():alert(n.data)},error:function(){alert("Server is not responding. Please reload page and try again")}})}function antipsychoticNoteLoaded(){$("#noteCreation").hide();$(".isDate").datepicker({onSelect:function(){$(this).parent().focus()}}).on("change",function(){$(this).valid()});$("#notedID").val()=="0"&&$("#NotedDate").val("");$("#closeNote").on("click",function(){$("#note").html("");$("#noteCreation").show()});$.validator.setDefaults({ignore:[]});$("#antiPsychoticNote").removeData("validator");$("#antiPsychoticNote").removeData("unobtrusiveValidation");$.validator.unobtrusive.parse($("#antiPsychoticNote"));$("#antiPsychoticNote").validate()}function loadNotesLists(){var n=$("#SOCEventId").val();$("#NotesArea").load(path+"StandardsOfCare/AntiPsychoticNoteListing?eventId="+n,function(){var n=$("#antiTable").dataTable({bFilter:!1,bAutoWidth:!1,sDom:"frtS",iDisplayLength:-1,aoColumns:[null,null,{bSearchable:!1,bSortable:!1},{bSearchable:!1,bSortable:!1},{bSearchable:!1,bSortable:!1}],oLanguage:{sEmptyTable:"No antipsychotic dates recorded"}});n.fnSort([[0,"desc"]]);$("#antiTable").on("click","a.edit",editAntiNote);$("#antiTable").on("click","a.copy",copyAntiNote);$("#antiTable").on("click",".delete",deleteAntiNote)})}function saveSuccessAntipsychotic(n){n.Success?($("#SOCEventId").val(n.id),$("#antiPsychoticNote").length>0?($("#antiPsychoticNote").find("#SOCEventId").val(n.id),saveAntipsychoticNote()):$("#modal").dialog("close"),updateTable()):alert("Error: Event not found in database")}function saveAntipsychoticNote(){$("#antiPsychoticNote").ajaxSubmit({iframe:!0,dataType:"json",success:function(n){n.Success?(loadNotesLists(),$("#modal").dialog("close")):alert("Error: Event not found in database")},error:function(){alert("Server is not responding. Please reload page and try again")}})}function createNote(){var n=$("#SOCEventId").val();$("#note").load(path+"StandardsOfCare/EditAntiPsychoticNote?eventId="+n,function(){$("#closeNote").hide();antipsychoticNoteLoaded()})}$(document).ready(function(){var n=$("#SOCEventId").val();loadNotesLists();n!="0"?$("#AntiPsychoticMedicationId").prop("disabled",!0):($("#OccurredDate").val(""),createNote());$("#AntiPsychoticDiagnosisId").val()=="4"?$("#OtherDiagnosisDetail").show():$("#OtherDiagnosisDetail").hide();$(".isDate").datepicker({onSelect:function(){$(this).parent().focus()}}).on("change",function(){$(this).valid()});$("#saveAnti").on("click",function(n){n.preventDefault();var t=$("#SaveAntipsychotic");t.valid()&&($("#antiPsychoticNote").length>0&&!$("#antiPsychoticNote").valid()||t.ajaxSubmit({iframe:!0,dataType:"json",success:saveSuccessAntipsychotic,error:function(){alert("Server is not responding. Please reload page and try again")}}))});$("#AntiPsychoticDiagnosisId").on("change",function(){$(this).val()=="4"?$("#OtherDiagnosisDetail").show():($("#OtherDiagnosisDetail").hide(),$("#OtherDiagnosisDetail").val(""))});$("#noteCreation").on("click",function(n){n.preventDefault();createNote()});$("#clearAnti").click(function(){$("#NotedDate, #ReducedDate, #LastAimsTestDate, #Recomendation, #TargetedBehavior").val("");$("#AntiPsychoticMedicationId").attr("disabled")==null&&$("#AntiPsychoticMedicationId").val("")});$.validator.addMethod("SOC_NoteDateExists",function(n){var i=getMomentDate(n),t=!0;return $(".noteDate").each(function(n,r){var u=getMomentDate($(r).text());u.diff(i)==0&&(t=!1)}),t},"A note with that date already exists, select another date.");$.validator.setDefaults({ignore:[]});$("#SaveAntipsychotic").removeData("validator");$("#SaveAntipsychotic").removeData("unobtrusiveValidation");$.validator.unobtrusive.parse($("#SaveAntipsychotic"));$("#SaveAntipsychotic").validate();$("#SaveAntipsychotic").show()});