function restraintNoteLoaded(){$("#closeNote").on("click",function(){$("#editNote").html("")});$("#notedID").val()=="0"&&($("#AttemptedReducedDate").val(""),$("#closeNote").hide());$("#DiagnosisSupportsRestraintFlg").is(":checked")&&$("#DiagnosisSupportsRestraintDesc").show();$("#DiagnosisSupportsRestraintFlg").on("click",function(){$("#DiagnosisSupportsRestraintDesc").toggle($(this).is(":checked"));$(this).is(":checked")?$("#DiagnosisSupportsRestraintDesc").rules("add","required"):$("#DiagnosisSupportsRestraintDesc").rules("remove","required")});$(".isDate").datepicker({onSelect:function(){$(this).parent().focus()}});$.validator.addMethod("reducedateexists",function(){var n=$("#AttemptedReducedDate").val(),t=$("#notedID").val(),i=$(".reduceDate").filter(function(){var i=$(this).closest("tr").attr("restraintid");return i==t?!1:n==$(this).text()?!0:$(this).text()==""?!1:n.indexOf($(this).text())!=-1}).length;return i<1},"Cannot have two entries with the same Date Reduced. Please change the date.");$.validator.setDefaults({ignore:[]});$("#saveRestraintNoteForm").removeData("validator");$("#saveRestraintNoteForm").removeData("unobtrusiveValidation");$.validator.unobtrusive.parse($("#saveRestraintNoteForm"));$("#saveRestraintNoteForm").validate()}function loadNoteList(){var n=$("#SOCEventId").val();$("#restraintNoteList").load(path+"StandardsOfCare/ListRestraintNotes?eventId="+n,function(){$("#restraintNoteTable").dataTable({bFilter:!1,bAutoWidth:!1,sDom:"frtS",iDisplayLength:-1});$("#restraintNoteTable").on("click",".edit",function(n){n.preventDefault();$("#editNote").load(this.href,restraintNoteLoaded)});$("#restraintNoteTable").on("click",".copy",function(n){n.preventDefault();$("#editNote").load(this.href,function(){$("#notedID").val("0");restraintNoteLoaded()})});$("#restraintNoteTable").on("click",".delete",function(n){n.preventDefault();var t=$(this).closest("tr");if($("#restraintNoteTable").find("tbody tr").length==1){alert("Cannot delete this row. One Noted Record must remain for each Standards of Care entry.");return}$.ajax({url:this.href,method:"post",success:function(n){n.Success?loadNoteList():alert(n.data)},error:function(){alert("Server is not responding. Please reload page and try again")}})})})}function restraintSaveSuccess(n){if(n.Success)if($("#saveRestraintNoteForm").length>0){var i=$("#saveRestraintNoteForm"),t=n.id;$("#SaveGenericForm").find("#SOCEventId").val(t);$("#saveRestraintNoteForm").find("#SOCEventId").val(t);i.ajaxSubmit({iframe:!0,dataType:"json",success:function(n){n.Success?($("#modal").dialog("close"),updateTable()):alert(n.data)},error:function(){alert("Server is not responding. Please reload page and try again")}})}else $("#modal").dialog("close"),updateTable();else alert("Error: Event not found in database")}$(document).ready(function(){var n=$("#SOCEventId").val();n=="0"&&($("#OccurredDate").val(""),$("#editNote").load(path+"StandardsOfCare/EditRestraintNote?eventId=0",restraintNoteLoaded));$(".isDate").datepicker().on("change",function(){$(this).valid()});loadNoteList();$("#saveEvent").on("click",function(n){n.preventDefault();var t=$("#SaveGenericForm");t.valid()&&($("#saveRestraintNoteForm").length>0&&!$("#saveRestraintNoteForm").valid()||t.ajaxSubmit({success:restraintSaveSuccess,dataType:"json",error:function(){alert("Server is not responding. Please reload page and try again")}}))});$("#SaveGenericForm").show()});$.validator.setDefaults({ignore:[]});$("#SaveGenericForm").removeData("validator");$("#SaveGenericForm").removeData("unobtrusiveValidation");$.validator.unobtrusive.parse($("#SaveGenericForm"));$("#SaveGenericForm").validate();