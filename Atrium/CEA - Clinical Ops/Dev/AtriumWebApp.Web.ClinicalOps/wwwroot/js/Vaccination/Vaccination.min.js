function initSidebar(){$("#listing").html("");$("#title").text("Vaccinations");$(".instruction").show();$(".vaccineSelector").hide()}function updateTable(){var r=$("#occurredRangeFrom").val(),u=checkDate(r),t,i,n,f;if(u=="invalid")return alert("Error: Please enter a valid From Date (mm/dd/yyyy)"),!1;if(u=="infuture")return alert("Error: You can not have a From date that is in the future"),!1;if(t=$("#occuredRangeTo").val(),i=checkDate(t),i=="invalid")return alert("Error: Please enter a valid To Date (mm/dd/yyyy)"),!1;if(i=="infuture")return alert("Error: You can not have a To date that is in the future"),!1;n=$("#Residents option:selected").val();n!="0"&&n!=""&&(f=path+"Vaccination/PatientInfo?="+n,$("#selectedResidentView").load(f,function(){$("#title").text("Vaccinations for "+$("#residentName").text())}),$("#listing").load(path+"Vaccination/GetVaccineList?patientId="+n+"&fromString="+encodeURIComponent(r)+"&toString="+encodeURIComponent(t),function(){$("#vaccineTable").dataTable({bFilter:!1,bAutoWidth:!1,aaSorting:[[1,"desc"]],sDom:"frtS",iDisplayLength:-1});$("#vaccineTable").on("click",".edit",function(n){n.preventDefault();var t=$(this).closest("tr").attr("vaccineId"),i=path+"Vaccination/EditVaccination?vaccineId="+t;$("#modal").load(i,formLoaded)});$("#vaccineTable").on("click",".delete",function(n){n.preventDefault();var t=$(this).closest("tr").attr("vaccineId"),i=path+"Vaccination/DeleteVaccine?vaccineId="+t;$.ajax({url:i,success:function(n){n.success?updateTable():alert(n.data)},error:function(){alert("Server is not responding. Please reload page and try again")}})})}))}function formLoaded(){$("#modal").dialog({width:"auto",height:"auto",resizable:!1,modal:!0,open:function(){$("#modal").parent().focus()},close:function(){$("#modal").dialog("destroy")}})}$("#sideBar").on("change","#Residents",function(){$("#Residents").val()!=""&&$("#Residents").val()!="0"?($(".instruction").hide(),$(".vaccineSelector").show(),updateTable()):($(".instruction").show(),$(".vaccineSelector").hide(),$("#listing").html(""))});$("#sideBar").on("click","#lookbackUpdate",function(n){n.preventDefault();var i=getMomentDate($("#LookbackDate").val()),t=checkDate($("#LookbackDate").val());t=="invalid"?alert("Error: Please enter a valid Last Census Date (mm/dd/yyyy)"):t=="infuture"?alert("Error: You can not have a Census date that is in the future"):(ShowProgress(),$("#SideDDL").ajaxSubmit({url:path+"Vaccination/UpdateSideBar",type:"POST",success:function(n){$("#sideBar").html(n);initSidebar()}}))});$("#sideBar").on("change","#Communities",function(){ShowProgress();$("#SideDDL").ajaxSubmit({url:path+"Vaccination/UpdateSideBar",type:"POST",success:function(n){$("#sideBar").html(n);initSidebar()}})});$(".isDate").datepicker();$("#updateTable").on("click",updateTable);$("#newVaccine").on("click",function(n){n.preventDefault();var t=$("#Residents option:selected").val(),i=$("#vaccineType").val();if(t==""||t=="0"||i==""){alert("Select a vaccine type to continue.");return}$("#modal").load(path+"Vaccination/EditVaccination?patientId="+t+"&vaccineTypeId="+i,formLoaded)});