function LookupAdminTable(n){this.editing=null;this.dataTable=$(n).dataTable({bFilter:!1,bAutoWidth:!1,sScrollY:"100px",sDom:"frtS",iDisplayLength:-1,aoColumns:[{sWidth:"160px"},{bSearchable:!1,bSortable:!1,sWidth:"20px"},{bSearchable:!1,bSortable:!1,sWidth:"20px"}],oLanguage:{sEmptyTable:"No Records"}});this.restoreRow=function(n){for(var i=this.dataTable.fnGetData(n),r=$(">td",n),t=0,u=r.length;t<u;t++)this.dataTable.fnUpdate(i[t],n,t,!1)};this.editRow=function(n){if(n!=null){var i=this.dataTable.fnGetData(n),t=$(">td",n);t[0].innerHTML='<input type="text" size="30" maxlength="30" value="'+i[0]+'"/>';t[1].innerHTML='<a class="edit" href="">Save<\/a> <a class="cancel" href="">Cancel<\/a>'}};this.saveRow=function(n,t,i){var r=this,u=$("input",n);$.ajax({url:i,dataType:"json",cache:!1,type:"POST",data:{id:t,name:u[0].value},success:function(t){t.Success&&(r.dataTable.fnUpdate(u[0].value,n,0,!1),r.dataTable.fnUpdate('<a class="edit" href="">Edit<\/a>',n,1,!1))},error:function(){alert("Server is not responding. Please reload page and try again")}})};this.deleteRow=function(n,t,i){var r=this;$.ajax({url:i,dataType:"json",cache:!1,type:"POST",data:{id:t},success:function(t){t.Success?r.dataTable.fnDeleteRow(n):alert("Error: Event not found in database")},error:function(){alert("Server is not responding. Please reload page and try again")}})}}function AdvancedLookupAdminTable(n){this.editing=null;this.dataTable=$(n).dataTable({bFilter:!1,bAutoWidth:!1,sScrollY:"100px",sDom:"frtS",iDisplayLength:-1,aoColumns:[{sWidth:"250px"},{sWidth:"10px"},{sWidth:"10px"},{sWidth:"10px"},{bSearchable:!1,bSortable:!1,sWidth:"15px"},{bSearchable:!1,bSortable:!1,sWidth:"15px"}],oLanguage:{sEmptyTable:"No Records"}});this.restoreRow=function(n){for(var i=this.dataTable.fnGetData(n),r=$(">td",n),t=0,u=r.length;t<u;t++)this.dataTable.fnUpdate(i[t],n,t,!1)};this.editRow=function(n){if(n!=null){var i=this.dataTable.fnGetData(n),r=$(".IsDataEntry",n).is(":checked"),u=$(".IsReportable",n).is(":checked"),t=$(">td",n);t[0].innerHTML='<input type="text" size="8" maxlength="16" value="'+i[0]+'"/>';t[1].innerHTML='<input type="text" size="2" maxlength="2" value="'+i[1]+'"/>';t[4].innerHTML='<a class="edit" href="">Save<\/a> <a class="cancel" href="">Cancel<\/a>'}};this.saveRow=function(n,t,i){var r=this,e=$("input",n),u=e[0].value,f=e[1].value,o=u,s=f,h,c;this.editing==null&&(o=$("td",n)[0].innerText,s=$("td",n)[1].innerText,u=null,f=null);h=$("#IsDataEntry",n);c=$("#IsReportable",n);$.ajax({url:i,dataType:"json",cache:!1,type:"POST",data:{id:t,name:u,isDataEntry:h.prop("checked"),isReportable:c.prop("checked"),sortOrder:f},success:function(t){t.Success&&(r.dataTable.fnUpdate(o,n,0,!1),r.dataTable.fnUpdate(s,n,1,!1),r.dataTable.fnUpdate('<a class="edit" href="">Edit<\/a>',n,4,!1))},error:function(){alert("Server is not responding. Please reload page and try again")}})};this.deleteRow=function(n,t,i){var r=this;$.ajax({url:i,dataType:"json",cache:!1,type:"POST",data:{id:t},success:function(t){t.Success?r.dataTable.fnDeleteRow(n):alert("Error: Event not found in database")},error:function(){alert("Server is not responding. Please reload page and try again")}})}}function alreadyExist(n,t,i){var u,r,f;for(i||(i=0),u=t.dataTable().fnGetData(),r=0;r<u.length;r++)if(f=u[r][i],f.toLowerCase()===n.toLowerCase())return!0;return!1}function createCheckboxString(n,t,i,r){var u,f;return r&&(u="checked"),f='<input class="'+t+'" id="'+n+'" name="'+i+'" type="checkbox" value="'+r+'" '+u+">",f+('<input name="'+i+'" type="hidden" value="'+r+'">')}function doPoll(){$("#processingSection").load(path+"ContractAdmin/GetProcessingFiles")}var ContractManagementAdmin=function(){function n(n,t){$(n.dataTable).on("click","a.edit",function(i){var r,u,f;i.preventDefault();r=$(this).parents("tr")[0];n.editing!==null&&n.editing!=r?(u=n.editing,n.restoreRow(u),n.editRow(r),n.editing=r):n.editing==r&&this.innerHTML=="Save"?(f=$(this).closest("tr").attr("id"),n.saveRow(n.editing,f,t),n.editing=null):(n.editRow(r),n.editing=r)})}function t(n,t){$(n.dataTable).on("click","a.delete",function(i){var r,u,f;i.preventDefault();r=confirm("Are you sure you want to delete?");r==!0&&(u=$(this).parents("tr")[0],f=$(this).closest("tr").attr("id"),n.deleteRow(u,f,t))})}function i(n){$(n.dataTable).on("click","a.cancel",function(t){t.preventDefault();var i=$(this).parents("tr")[0];n.restoreRow(i);n.editing=null})}function r(n,t){$(n.dataTable).on("click",'[type="checkbox"]',function(){var i=$(this).parents("tr")[0],r=$(this).closest("tr").attr("id");n.saveRow(i,r,t)})}return{setupLookupAdminTable:function(r,u,f){var e=new LookupAdminTable(r);return n(e,u),t(e,f),i(e),e},setupAdvancedLookupAdminTable:function(u,f,e){var o=new AdvancedLookupAdminTable(u);n(o,f);t(o,e);i(o);r(o,f)}}}();$(function(){$("#tabs").tabs();ContractManagementAdmin.setupLookupAdminTable("#addressTypesTable",path+"/ContractAdmin/EditAddressType",path+"/ContractAdmin/DeleteAddressType");ContractManagementAdmin.setupLookupAdminTable("#contactTypesTable",path+"/ContractAdmin/EditContactType",path+"/ContractAdmin/DeleteContactType");ContractManagementAdmin.setupLookupAdminTable("#categoriesTable",path+"/ContractAdmin/EditCategory",path+"/ContractAdmin/DeleteCategory");var n=ContractManagementAdmin.setupLookupAdminTable("#subCategoryTable",path+"/ContractAdmin/EditSubCategory",path+"/ContractAdmin/DeleteSubCategory");ContractManagementAdmin.setupAdvancedLookupAdminTable("#paymentTermTable",path+"/ContractAdmin/EditPaymentTerm",path+"/ContractAdmin/DeletePaymentTerm");ContractManagementAdmin.setupAdvancedLookupAdminTable("#renewalTypesTable",path+"/ContractAdmin/EditRenewalType",path+"/ContractAdmin/DeleteRenewalType");ContractManagementAdmin.setupAdvancedLookupAdminTable("#terminationNoticeTable",path+"/ContractAdmin/EditTerminationNotice",path+"/ContractAdmin/DeleteTerminationNotice");$("#newAddressType").click(function(n){n.preventDefault();var t=$("#addressTab form"),r=$("#newAddressType_Name").val(),i=$("#addressTypesTable").dataTable();if(!t.valid())return!1;$.ajax({url:t.attr("action"),dataType:"json",type:"POST",data:t.serialize(),success:function(n){if(n.Success){var r=n.data.Name,o=n.data.SortOrder,u=n.data.Id,f=i.fnAddData([r,'<a class="edit" href="">Edit<\/a>','<a class="delete" href="">Delete<\/a>']),e=i.fnSettings().aoData[f[0]].nTr;e.setAttribute("id",u);t[0].reset()}else alert(n.message)},error:function(){alert("Server is not responding. Please reload page and try again")}})});$("#newContactType").click(function(n){n.preventDefault();var t=$("#contactTab form"),r=$("#newContactType_Name").val(),i=$("#contactTypesTable").dataTable();if(!t.valid())return!1;$.ajax({url:t.attr("action"),dataType:"json",type:"POST",data:t.serialize(),success:function(n){if(n.Success){var r=n.data.Name,o=n.data.SortOrder,u=n.data.Id,f=i.fnAddData([r,'<a class="edit" href="">Edit<\/a>','<a class="delete" href="">Delete<\/a>']),e=i.fnSettings().aoData[f[0]].nTr;e.setAttribute("id",u);t[0].reset()}else alert(n.message)},error:function(){alert("Server is not responding. Please reload page and try again")}})});$("#newCategory").click(function(n){n.preventDefault();var t=$("#categoryTab form"),r=$("#newContractCategory_Name").val(),i=$("#categoriesTable").dataTable();if(alreadyExist(r,i))return alert("Category already exists"),!1;if(!t.valid())return!1;$.ajax({url:t.attr("action"),dataType:"json",type:"POST",data:t.serialize(),success:function(n){var f;if(n.Success){var r=n.data.Name,o=n.data.SortOrder,u=n.data.Id,e=i.fnAddData([r,'<a class="edit" href="">Edit<\/a>','<a class="delete" href="">Delete<\/a>']);$("#Categories").append("<option value='"+u+"'>"+r+"<\/option>");f=i.fnSettings().aoData[e[0]].nTr;f.setAttribute("id",u);t[0].reset()}else alert(n.message)},error:function(){alert("Server is not responding. Please reload page and try again")}})});$("#newSubcategory").click(function(n){n.preventDefault();var t=$("#subcategoryTab form"),r=$("#newContractSubcategory_Name").val(),i=$("#subCategoryTable").dataTable();if(alreadyExist(r,i))return alert("Subcategory already exists"),!1;if(!t.valid())return!1;$.ajax({url:t.attr("action"),dataType:"json",type:"POST",data:t.serialize(),success:function(n){if(n.Success){var r=n.data.Name,u=n.data.Id,f=i.fnAddData([r,'<a class="edit" href="">Edit<\/a>','<a class="delete" href="">Delete<\/a>']),e=i.fnSettings().aoData[f[0]].nTr;e.setAttribute("id",u);t[0].reset()}else alert(n.message)},error:function(){alert("Server is not responding. Please reload page and try again")}})});$("#newRenewalType").click(function(n){n.preventDefault();var t=$("#renewalTab form"),r=$("#newContractRenewal_Name").val(),i=$("#renewalTypesTable").dataTable();if(alreadyExist(r,i))return alert("Renewal type already exists"),!1;if(!t.valid())return!1;$.ajax({url:t.attr("action"),dataType:"json",type:"POST",data:t.serialize(),success:function(n){if(n.Success){var r=n.data.Name,u=n.data.Id,f=n.data.SortOrder,e=n.data.IsDataEntry,o=n.data.IsReportable,s=i.fnAddData([r,f,createCheckboxString("IsDataEntry","IsDataEntry","IsDataEntry",e),createCheckboxString("IsReportable","IsReportable","IsReportable",o),'<a class="edit" href="">Edit<\/a>','<a class="delete" href="">Delete<\/a>']),h=i.fnSettings().aoData[s[0]].nTr;h.setAttribute("id",u);t[0].reset()}else alert(n.message)},error:function(){alert("Server is not responding. Please reload page and try again")}})});$("#newTerminationNotice").click(function(n){n.preventDefault();var t=$("#termTab form"),r=$("#newTermNotice_Name").val(),i=$("#terminationNoticeTable").dataTable();if(alreadyExist(r,i))return alert("Terminiation notice already exists"),!1;if(!t.valid())return!1;$.ajax({url:t.attr("action"),dataType:"json",type:"POST",data:t.serialize(),success:function(n){if(n.Success){var r=n.data.Name,u=n.data.Id,f=n.data.SortOrder,e=n.data.IsDataEntry,o=n.data.IsReportable,s=i.fnAddData([r,f,createCheckboxString("IsDataEntry","IsDataEntry","IsDataEntry",e),createCheckboxString("IsReportable","IsReportable","IsReportable",o),'<a class="edit" href="">Edit<\/a>','<a class="delete" href="">Delete<\/a>']),h=i.fnSettings().aoData[s[0]].nTr;h.setAttribute("id",u);t[0].reset()}else alert(n.message)},error:function(){alert("Server is not responding. Please reload page and try again")}})});$("#newPaymentTerm").click(function(n){n.preventDefault();var t=$("#paymentTab form"),r=$("#newPaymentTerm_Name").val(),i=$("#paymentTermTable").dataTable();if(alreadyExist(r,i))return alert("Payment term already exists"),!1;if(!t.valid())return!1;$.ajax({url:t.attr("action"),dataType:"json",type:"POST",data:t.serialize(),success:function(n){if(n.Success){var r=n.data.Name,u=n.data.Id,f=n.data.SortOrder,e=n.data.IsDataEntry,o=n.data.IsReportable,s=i.fnAddData([r,f,createCheckboxString("IsDataEntry","IsDataEntry","IsDataEntry",e),createCheckboxString("IsReportable","IsReportable","IsReportable",o),'<a class="edit" href="">Edit<\/a>','<a class="delete" href="">Delete<\/a>']),h=i.fnSettings().aoData[s[0]].nTr;h.setAttribute("id",u);t[0].reset()}else alert(n.message)},error:function(){alert("Server is not responding. Please reload page and try again")}})});$("#Categories").on("change",function(t){t.preventDefault();var i=$(this).add("option:selected").val();$("#SelectedCategoryId").val(i);$.ajax({url:path+"/ContractAdmin/GetSubCategories",type:"POST",data:{selectedCategoryId:i},datatype:"json",success:function(t){var i;for(n.dataTable.fnClearTable(!0),i=0;i<t.length;i++){var r=t[i].Id,u=t[i].Name,f=n.dataTable.fnAddData([u,'<a class="edit" href="">Edit<\/a>','<a class="delete" href="">Delete<\/a>'],!1),e=n.dataTable.fnSettings().aoData[f[0]].nTr;e.setAttribute("id",r)}n.dataTable.fnDraw()},error:function(){alert("Could not communicate with the server.")}})});$("#tabs").tabs({activate:function(n,t){var r=t.newPanel.find(".dataTable").filter(function(){return this.id!=""}),u;for(i=0;i<r.length;i++)u=$("#"+r[i].id).dataTable(),u.fnAdjustColumnSizing()}});doPoll()});$(document).ajaxSend(function(){ShowProgress()});$(document).ajaxComplete(function(){HideProgress()});$("#exportContracts").on("click",function(){var n=$("#facilityExport").val(),t;if(n.length==0){alert("At least one facility should be selected to export.");return}t=n.join("&facilityIds=");$.ajax({url:path+"ContractAdmin/GetContracts?facilityIds="+t,success:function(){doPoll()},failure:function(){alert("There was an error exporting, please refresh the page and try again.")}})});$("#processingSection").on("click","#refreshProgress",doPoll);