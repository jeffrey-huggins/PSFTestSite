function PreparePage(){function r(){HideTableIfNoRows($("#documents"));HideTableIfNoRows($("#contacts"));HideTableIfNoRows($("#addresses"))}function u(){}var t=0,n=$("#formContent"),i=$("#contractProvidersTable").dataTable({bAutoWidth:!1,sScrollY:"600px",sDom:"rt",iDisplayLength:-1,aaSorting:[[0,"desc"]],aoColumns:[{sWidth:"160px"},{sWidth:"20px"},{sWidth:"20px"},{sWidth:"140px"},{sWidth:"100px"},{sWidth:"20px"},{sWidth:"10px",bSortable:!1},{sWidth:"10px",bSortable:!1}],oLanguage:{sEmptyTable:"No records within this range."}});$("#createProvider").click(function(t){var i=$(this);t.preventDefault();$.ajax({url:i.attr("href"),success:function(t){n.html(t);InitializeDates();n.show();u();r()},error:function(){alert("Could not communicate with the server.")}})});i.on("click",".deleteProvider",function(n){var t=$(this);n.preventDefault();confirm("Are you sure you would like to delete this Provider/Vendor?")&&$.ajax({url:t.attr("href"),type:"post",success:function(n){if(n.Success){var r=t.closest("tr"),u=r.get(0),f=i.fnGetPosition(u);i.fnDeleteRow(f)}else $("#errorResult").html(n.ErrorMessage),$("#errorList").show().delay(5e3).fadeOut(5e3);SetCountDownTime(1800)},error:function(){alert("Could not communicate with the server.")}})});i.on("click",".editProvider",function(t){var i=$(this);t.preventDefault();$.ajax({url:i.attr("href"),success:function(t){n.html(t);InitializeDates();n.show();u();r()},error:function(){alert("Could not communicate with the server.")}})});i.on("click",".viewProvider",function(t){var i=$(this);t.preventDefault();$.ajax({url:i.attr("href"),success:function(t){n.html(t);n.show();r()},error:function(){alert("Could not communicate with the server.")}})});n.on("click","#submitProvider",function(n){var t;n.preventDefault();ShowProgress();var i=$(this),r=i.closest("form"),u=r.attr("action"),t="Documents";return $("#documents tr").each(function(n){ApplyUniqueItemIndex($(this),n-1,t)}),t="Contacts",$("#contacts tr").each(function(n){ApplyUniqueItemIndex($(this),n-1,t)}),t="Addresses",$("#addresses tr").each(function(n){ApplyUniqueItemIndex($(this),n-1,t)}),$.ajax({url:u,type:"POST",data:$("#providerEditForm").serialize(),success:function(n){try{var t=n;t.Success&&(window.location.replace(path+"ContractProvider/Providers"),$("#providerEditForm").hide())}catch(i){}},error:function(){alert("Failure communicating with the server.")}}),!1});n.on("click","#addDocument",function(n){n.preventDefault();$.ajax({url:path+"/ContractProvider/CreateDocument",success:function(n){var i=$(n),r;ApplyUniqueItemIndex(i,t,"Documents");t++;r=$("#documents");$("#documents").append(i);ShowTable($("#documents"));InitializeDates()},error:function(){alert("Failure communicating with the server.")}})});n.on("click","#addContact",function(n){n.preventDefault();$.ajax({url:path+"/ContractProvider/CreateContact",success:function(n){var i=$(n);ApplyUniqueItemIndex(i,t,"Contacts");t++;$("#contacts").append(i);ShowTable($("#contacts"));InitializeDates()},error:function(){alert("Failure communicating with the server.")}})});n.on("click","#addAddress",function(n){n.preventDefault();$.ajax({url:path+"/ContractProvider/CreateAddress",success:function(n){var i=$(n);ApplyUniqueItemIndex(i,t,"Addresses");t++;$("#addresses").append(i);ShowTable($("#addresses"));InitializeDates()},error:function(){alert("Failure communicating with the server.")}})});n.on("click","#documents .delete-item",function(n){n.preventDefault();$(this).closest("tr").remove()});n.on("click","#addresses .delete-item",function(n){n.preventDefault();$(this).closest("tr").remove()});n.on("click","#contacts .delete-item",function(n){n.preventDefault();$(this).closest("tr").remove()});n.on("click","#clearProvider",function(){window.location.replace(path+"ContractProvider/Providers")})}