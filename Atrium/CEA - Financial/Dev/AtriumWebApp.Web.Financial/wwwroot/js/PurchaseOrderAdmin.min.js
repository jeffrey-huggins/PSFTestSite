function LookupAdminTable(n){this.editing=null;this.dataTable=$(n).dataTable({bFilter:!1,bAutoWidth:!1,sScrollY:"100px",sDom:"frtS",iDisplayLength:-1,aoColumns:[{sWidth:"200px"},null,{mRender:function(n){var t='<input type="checkbox" name="EnableDisable" class="EnableDisable" value="'+n;return n===!0||n==="True"||n==="true"?t+'" checked="checked" />':t+'" />'}},{bSearchable:!1,bSortable:!1,sWidth:"20px"},{bSearchable:!1,bSortable:!1,sWidth:"20px"}],oLanguage:{sEmptyTable:"No Records"}});this.restoreRow=function(n){for(var i=this.dataTable.fnGetData(n),r=$(">td",n),t=0,u=r.length;t<u;t++)this.dataTable.fnUpdate(i[t],n,t,!1)};this.editRow=function(n){var i=this.dataTable.fnGetData(n),t=$(">td",n);t[0].innerHTML='<input type="text" size="30" maxlength="30" value="'+i[0]+'"/>';t[1].innerHTML='<input type="text" size="3" value="'+i[1]+'"/>';t[3].innerHTML='<a class="edit" href="">Save<\/a> <a class="cancel" href="">Cancel<\/a>'};this.enableDisable=function(n,t,i){var e=this,u=this.dataTable.fnGetData(n),f=$(".EnableDisable",n),r=f.is(":checked");$.ajax({url:i,dataType:"json",cache:!1,type:"POST",data:{id:t,name:u[0],order:u[1],allowDataEntry:r},success:function(t){t.Success?e.dataTable.fnUpdate(r,n,2,!1):(f.prop("checked",!r),alert("Record has failed to be enabled/disabled. Please try again and if you see this message repeatedly the server may be down."))}})};this.saveRow=function(n,t,i){var r=this,u=$("input",n),f=$(".EnableDisable",n).is(":checked");$.ajax({url:i,dataType:"json",cache:!1,type:"POST",data:{id:t,name:u[0].value,order:u[1].value,allowDataEntry:f},success:function(t){t.Success&&(r.dataTable.fnUpdate(u[0].value,n,0,!1),r.dataTable.fnUpdate(u[1].value,n,1,!1),r.dataTable.fnUpdate(f,n,2,!1),r.dataTable.fnUpdate('<a class="edit" href="">Edit<\/a>',n,3,!1))},error:function(){alert("Server is not responding. Please reload page and try again")}})};this.deleteRow=function(n,t,i){var r=this;$.ajax({url:i,dataType:"json",cache:!1,type:"POST",data:{id:t},success:function(t){t.Success?r.dataTable.fnDeleteRow(n):alert("Error: Event not found in database")},error:function(){alert("Server is not responding. Please reload page and try again")}})}}function ApproverLookupAdminTable(n){this.editing=null;this.dataTable=$(n).dataTable({bFilter:!1,bAutoWidth:!1,sScrollY:"100px",sDom:"frtS",iDisplayLength:-1,aoColumns:[{sWidth:"300px"},null,{bSearchable:!1,bSortable:!1,sWidth:"20px"},{bSearchable:!1,bSortable:!1,sWidth:"20px"}],oLanguage:{sEmptyTable:"No Records"}});this.restoreRow=function(n){for(var i=this.dataTable.fnGetData(n),r=$(">td",n),t=0,u=r.length;t<u;t++)this.dataTable.fnUpdate(i[t],n,t,!1)};this.editRow=function(n){var i=this.dataTable.fnGetData(n),t=$(">td",n);t[0].innerHTML='<input type="text" size="30" maxlength="256" value="'+i[0]+'"/>';t[1].innerHTML='<input type="text" size="1" value="'+i[1]+'"/>';t[2].innerHTML='<a class="edit" href="">Save<\/a> <a class="cancel" href="">Cancel<\/a>'};this.saveRow=function(n,t,i){var u=this,r=$("input",n);$.ajax({url:i,dataType:"json",cache:!1,type:"POST",data:{id:t,name:r[0].value,approvalLevel:r[1].value},success:function(t){t.Success&&(u.dataTable.fnUpdate(r[0].value,n,0,!1),u.dataTable.fnUpdate(r[1].value,n,1,!1),u.dataTable.fnUpdate('<a class="edit" href="">Edit<\/a>',n,2,!1))},error:function(){alert("Server is not responding. Please reload page and try again")}})};this.deleteRow=function(n,t,i){var r=this;$.ajax({url:i,dataType:"json",cache:!1,type:"POST",data:{id:t},success:function(t){t.Success?r.dataTable.fnDeleteRow(n):alert("Error: Event not found in database")},error:function(){alert("Server is not responding. Please reload page and try again")}})}}function CommunityAdminTable(n){this.dataTable=$(n).dataTable({bFilter:!1,bAutoWidth:!1,aaSorting:[],sScrollY:"600px",sDom:"frtS",iDisplayLength:-1,aoColumns:[null,null,null,{bSearchable:!1,bSortable:!1,sWidth:"20px"},{bSearchable:!1,bSortable:!1,sWidth:"20px"}],oLanguage:{sEmptyTable:"No Communities"}});this.wireupDisplayUpdateHandler=function(n){$(".checkboxDisplay").click(function(){var t=$(this).is(":checked"),i=$(this).attr("id"),r=$(this).parents("tr").children(":first-child").text();$.ajax({url:n,dataType:"json",cache:!1,type:"POST",data:{community:i,dFlag:t,appCode:"POR"},success:function(n){n.Success||alert("Community has failed to be enabled/disabled. Please try again and if you see this message repeatedly the server may be down.")}})})};this.wireupReportUpdateHandler=function(n){$(".checkboxReport").click(function(){var t=$(this).is(":checked"),i=$(this).attr("id"),r=$(this).parents("tr").children(":first-child").text();$.ajax({url:n,dataType:"json",cache:!1,type:"POST",data:{community:i,dFlag:t,appCode:"POR"},success:function(n){n.Success||alert("Community report flag has failed to be enabled/disabled. Please try again and if you see this message repeatedly the server may be down.")}})})}}function initVendors(){var t=$("#vendor"),n=$("form",t),i=$("#VendorTable").dataTable({bAutoWidth:!1,bFilter:!0,sScrollY:"450px",sDom:"frt",iDisplayLength:-1,aoColumns:[{bSearchable:!0},{bSearchable:!1,sWidth:"85px"},{bSearchable:!1,sWidth:"75px"},{bSearchable:!1},{bSearchable:!1,sWidth:"100px"},{bSearchable:!1,sWidth:"100px"},{bSearchable:!1},{bSearchable:!1,sWidth:"80px"},{bSearchable:!1,bSortable:!1}],oLanguage:{sEmptyTable:"No entries for date range selected"}});i.fnSort([[0,"asc"]]);$("#VendorTable").on("click","a.edit",function(n){n.preventDefault();var r=$(this).parents("tr")[0],i=parseInt($(this).closest("tr").attr("id"));$.ajax({url:path+"PurchaseOrderAdmin/GetVendor",dataType:"json",cache:!1,type:"GET",data:{vendorId:i},success:function(n){LaunchModal(t,n)},error:function(){alert("Server is not responding. Please reload page and try again")}})});$("#btnCreate").click(function(n){n.preventDefault();LaunchModal(t)});$("#btnSave").click(function(){ValidateForm()&&$.ajax({url:$(n).attr("action"),dataType:"json",cache:!1,type:$(n).attr("method"),data:n.serialize(),success:function(n){alert("Vendor Record has been successfully saved.");UpdateVendorTable(n);$("#btnClose").click()},error:function(){alert("Server is not responding. Please reload the page and try again")}})});$("#btnClear").click(function(){$("#VendorName",n).val("");$("#VendorClassId",n).val("");$("#CorpVendorId",n).val("");$("#Address1",n).val("");$("#Address2",n).val("");$("#City",n).val("");$("#StateCd",n).val("");$("#ZipCode",n).val("");$("#Phone",n).val("");$("#Fax",n).val("");$("#Email",n).val("")});$("#btnClose").click(function(){$(".modal, #vendor").hide();$("#Id",n).val("");$("#AllowDataEntry",n).val("true");$("#btnClear").click()});$("#VendorTable").on("click",".EnableDisable",function(){var t=$(this),n=$(this).is(":checked"),i=$(this).closest("tr").attr("id");$.ajax({url:path+"PurchaseOrderAdmin/UpdateVendorDataEntryFlag",dataType:"json",cache:!1,type:"POST",data:{vendorId:i,allowDataEntry:n},success:function(){},error:function(i){i.status!=200&&(t.prop("checked",!n),alert("Vendor has failed to be enabled/disabled. Please try again and if you see this message repeatedly the server may be down."))}})})}function LaunchModal(n,t){var i=$("<div />"),r,u;i.addClass("modal");$("body").append(i);n.show();r=Math.max($(window).height()/2-n[0].offsetHeight/2,0);u=Math.max($(window).width()/2-n[0].offsetWidth/2,0);n.css({top:r,left:u});t&&($("#Id",n).val(t.Id),$("#VendorName",n).val(t.VendorName),$("#VendorClassId",n).val(t.VendorClassId),$("#CorpVendorId",n).val(t.CorpVendorId),$("#Address1",n).val(t.Address1),$("#Address2",n).val(t.Address2),$("#City",n).val(t.City),$("#StateCd",n).val(t.StateCd),$("#ZipCode",n).val(t.ZipCode),$("#Phone",n).val(t.Phone),$("#Fax",n).val(t.Fax),$("#Email",n).val(t.Email),$("#AllowDataEntry",n).val(t.AllowDataEntry))}function ValidateForm(n){return IsFieldEmpty($("#VendorName",n).val())?(alert("Vendor is a required field."),!1):IsFieldEmpty($("#VendorClassId",n).val())?(alert("Vendor Class is a required field."),!1):IsFieldEmpty($("#Address1",n).val())?(alert("Address 1 is a required field."),!1):IsFieldEmpty($("#City",n).val())?(alert("City is a required field."),!1):IsFieldEmpty($("#StateCd",n).val())?(alert("State is a required field."),!1):IsFieldEmpty($("#ZipCode",n).val())?(alert("Zip Code is a required field."),!1):!0}function UpdateVendorTable(n){var t=$("#VendorTable").dataTable(),i=document.getElementById(n.Id),r;i!=null?(t.fnUpdate(n.VendorName,i,0,!1),t.fnUpdate(n.VendorClass.Name,i,1,!1),t.fnUpdate(n.CorpVendorId,i,2,!1),t.fnUpdate(n.FullAddress.replace(/\n/g,"<br />"),i,3,!1),t.fnUpdate(n.Phone,i,4,!1),t.fnUpdate(n.Fax,i,5,!1),t.fnUpdate(n.Email,i,6,!1)):(r=t.fnAddData([n.VendorName,n.VendorClass.Name,n.CorpVendorId,n.FullAddressRaw,n.Phone,n.Fax,n.Email,'<input id="EnableDisable_'+n.Id+'" name="EnableDisable" class="EnableDisable" type="checkbox" checked="checked" value="true" />','<a class="edit" href="">Edit<\/a>']),i=t.fnSettings().aoData[r[0]].nTr,i.setAttribute("id",n.Id));t.fnSort([[0,"asc"]])}function IsFieldEmpty(n){return n===""||n===null||n===undefined}function alreadyExist(n,t,i){var u,r,f;for(i||(i=0),u=t.dataTable().fnGetData(),r=0;r<u.length;r++)if(f=u[r][i],f.toLowerCase()===n.toLowerCase())return!0;return!1}function createCheckboxString(n,t,i,r){var u,f;return r&&(u="checked"),f='<input class="'+t+'" id="'+n+'" name="'+i+'" type="checkbox" value="'+r+'" '+u+">",f+('<input name="'+i+'" type="hidden" value="'+r+'">')}var PurchaseOrderAdmin=function(){function n(n,t){$(n.dataTable).on("click","a.edit",function(i){var r,u,f;i.preventDefault();r=$(this).parents("tr")[0];n.editing!==null&&n.editing!=r?(u=n.editing,n.restoreRow(u),n.editRow(r),n.editing=r):n.editing==r&&this.innerHTML=="Save"?(f=$(this).closest("tr").attr("id"),n.saveRow(n.editing,f,t),n.editing=null):(n.editRow(r),n.editing=r)})}function t(n,t){$(n.dataTable).on("click","a.delete",function(i){var r,u,f;i.preventDefault();r=confirm("Are you sure you want to delete?");r==!0&&(u=$(this).parents("tr")[0],f=$(this).closest("tr").attr("id"),n.deleteRow(u,f,t))})}function i(n){$(n.dataTable).on("click","a.cancel",function(t){t.preventDefault();var i=$(this).parents("tr")[0];n.restoreRow(i);n.editing=null})}return{setupLookupAdminTable:function(r,u,f){var e=new LookupAdminTable(r);n(e,u);t(e,f);i(e);$(e.dataTable).on("click",".EnableDisable",function(){if(!e.editing){var n=$(this).parents("tr")[0],t=$(this).closest("tr").attr("id");e.enableDisable(n,t,u)}});return e},setupApproverLookupAdminTable:function(r,u,f){var e=new ApproverLookupAdminTable(r);n(e,u);t(e,f);i(e)},setupCommunityTable:function(n,t,i){var r=new CommunityAdminTable(n);return r.wireupDisplayUpdateHandler(t),r.wireupReportUpdateHandler(i),r}}}();$(document).ready(function(){$("#tabs").tabs();PurchaseOrderAdmin.setupLookupAdminTable("#Types",path+"/PurchaseOrderAdmin/EditType",path+"/PurchaseOrderAdmin/DeleteType");PurchaseOrderAdmin.setupLookupAdminTable("#VendorClasses",path+"/PurchaseOrderAdmin/EditVendorClass",path+"/PurchaseOrderAdmin/DeleteVendorClass");PurchaseOrderAdmin.setupLookupAdminTable("#AssetClasses",path+"/PurchaseOrderAdmin/EditAssetClass",path+"/PurchaseOrderAdmin/DeleteAssetClass");PurchaseOrderAdmin.setupApproverLookupAdminTable("#Approvers",path+"/PurchaseOrderAdmin/EditApprover",path+"/PurchaseOrderAdmin/DeleteApprover");PurchaseOrderAdmin.setupCommunityTable("#CommunityTable",path+"/PurchaseOrderAdmin/ChangeDataFlgCom",path+"/PurchaseOrderAdmin/ChangeReportFlgCom");initVendors();$("#newPurchaseOrderType").click(function(n){n.preventDefault();var t=$("#orderTypeTab form"),r=$("#NewType_Name").val(),i=$("#Types").dataTable();if(alreadyExist(r,i))return alert("Purchase Order Type already exists"),!1;if(!t.valid())return!1;$.ajax({url:t.attr("action"),dataType:"json",type:"POST",data:t.serialize(),success:function(n){if(n.Success){var r=n.data.Name,u=n.data.SortOrder,f=n.data.AllowDataEntry,e=n.data.Id,o=i.fnAddData([r,u,f,'<a class="edit" href="">Edit<\/a>','<a class="delete" href="">Delete<\/a>']),s=i.fnSettings().aoData[o[0]].nTr;s.setAttribute("id",e);t[0].reset()}else alert(n.message)},error:function(){alert("Server is not responding. Please reload page and try again")}})});$("#newVendorClass").click(function(n){n.preventDefault();var t=$("#vendorClassTab form"),r=$("#NewVendorClass_Name").val(),i=$("#VendorClasses").dataTable();if(alreadyExist(r,i))return alert("Vendor Class already exists"),!1;if(!t.valid())return!1;$.ajax({url:t.attr("action"),dataType:"json",type:"POST",data:t.serialize(),success:function(n){if(n.Success){var r=n.data.Name,u=n.data.SortOrder,f=n.data.AllowDataEntry,e=n.data.Id,o=i.fnAddData([r,u,f,'<a class="edit" href="">Edit<\/a>','<a class="delete" href="">Delete<\/a>']),s=i.fnSettings().aoData[o[0]].nTr;s.setAttribute("id",e);t[0].reset()}else alert(n.message)},error:function(){alert("Server is not responding. Please reload page and try again")}})});$("#newAssetClass").click(function(n){n.preventDefault();var t=$("#assetClassTab form"),r=$("#NewAssetClass_Name").val(),i=$("#AssetClasses").dataTable();if(alreadyExist(r,i))return alert("Asset Class already exists"),!1;if(!t.valid())return!1;$.ajax({url:t.attr("action"),dataType:"json",type:"POST",data:t.serialize(),success:function(n){if(n.Success){var r=n.data.Name,u=n.data.SortOrder,f=n.data.AllowDataEntry,e=n.data.Id,o=i.fnAddData([r,u,f,'<a class="edit" href="">Edit<\/a>','<a class="delete" href="">Delete<\/a>']),s=i.fnSettings().aoData[o[0]].nTr;s.setAttribute("id",e);t[0].reset()}else alert(n.message)},error:function(){alert("Server is not responding. Please reload page and try again")}})});$("#newPurchaseOrderApprover").click(function(n){n.preventDefault();var t=$("#approverTab form"),r=$("#NewApprover_Name").val(),i=$("#Approvers").dataTable();if(alreadyExist(r,i))return alert("Approver already exists"),!1;if(!t.valid())return!1;$.ajax({url:t.attr("action"),dataType:"json",type:"POST",data:t.serialize(),success:function(n){if(n.Success){var r=n.data.Name,u=n.data.Id,f=n.data.ApprovalLevel,e=i.fnAddData([r,f,'<a class="edit" href="">Edit<\/a>','<a class="delete" href="">Delete<\/a>']),o=i.fnSettings().aoData[e[0]].nTr;o.setAttribute("id",u);t[0].reset()}else alert(n.message)},error:function(){alert("Server is not responding. Please reload page and try again")}})});$("#tabs").tabs({activate:function(n,t){var r=t.newPanel.find(".dataTable").filter(function(){return this.id!=""}),u;for(i=0;i<r.length;i++)u=$("#"+r[i].id).dataTable(),u.fnAdjustColumnSizing()}})});$(document).ajaxSend(function(){ShowProgress()});$(document).ajaxStop(function(){HideProgress()});