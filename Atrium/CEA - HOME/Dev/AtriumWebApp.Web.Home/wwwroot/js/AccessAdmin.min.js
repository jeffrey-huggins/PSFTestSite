function initGeneralAccess(){$("#applicationAccess").DataTable({filter:!1,scrollY:"400px",autoWidth:!0,dom:"frtS",displayLength:-1,sorting:[[2,"asc"]],columns:[null,null,null,null],language:{emptyTable:"No Records"}});$("#appUsers").DataTable({filter:!1,autoWidth:!0,scrollY:"400px",dom:"frtS",displayLength:-1,language:{emptyTable:"No users have access to this app"}});$("#applicationAccess").find("tr").click(function(n){var t=n.target;(t||(t=n.srcElement),t.localName!="input")&&($("#applicationAccess").find("tr").removeClass("highlight"),$("#applicationAccess").find("tr").addClass("borderRow"),$(this).addClass("highlight"),$(this).removeClass("borderRow"),getApplicationUserAccess($(this).attr("appId")))});$(".appAccess").change(function(){var n=$(this).prop("checked"),t=$(this).closest("tr").attr("appId");setApplicationUserAccess(t,n)})}function initObjectAccess(){$("#objectUsers").DataTable({filter:!1,autoWidth:!0,scrollY:"400px",dom:"frtS",displayLength:-1,language:{sEmptyTable:"No users have access to this object"}});$("#objectAccess").DataTable({filter:!1,autoWidth:!0,scrollY:"400px",dom:"frtS",displayLength:-1,sorting:[[2,"asc"],[1,"asc"]],columns:[null,null,null,null],language:{emptyTable:"No Records"}});$("#objectAccess").find("tr").click(function(){var n=event.target;(n||(n=event.srcElement),n.localName!="input")&&($("#objectAccess").find("tr").removeClass("highlight"),$("#objectAccess").find("tr").addClass("borderRow"),$(this).addClass("highlight"),$(this).removeClass("borderRow"),getObjectUserAccess($(this).attr("objectid")))});$(".objectAccess").change(function(){var n=$(this).prop("checked"),t=$(this).closest("tr").attr("objectid");setObjectUserAccess(t,n)})}function initAdminAccess(){$("#adminUsers").DataTable({filter:!1,autoWidth:!0,scrollY:"400px",dom:"frtS",displayLength:-1,language:{sEmptyTable:"No admins are setup for this app"}});$("#adminAccess").DataTable({filter:!1,autoWidth:!0,scrollY:"400px",dom:"frtS",displayLength:-1,sorting:[[2,"asc"]],columns:[null,null,null],language:{emptyTable:"No Records"}});$("#adminAccess").find("tr").click(function(){var n=event.target;(n||(n=event.srcElement),n.localName!="input")&&($("#adminAccess").find("tr").removeClass("highlight"),$("#adminAccess").find("tr").addClass("borderRow"),$(this).addClass("highlight"),$(this).removeClass("borderRow"),getAdminList($(this).attr("adminappid")))})}function initCommunityStatus(){$("#communityTable").DataTable({filter:!1,autoWidth:!0,scrollY:"400px",dom:"frtS",displayLength:-1,language:{emptyTable:"No communities exist"}});$(".allDataEntry").on("change",function(){$("#communityTable").find(".dataFlag").prop("checked",$(".allDataEntry").prop("checked"));$("#communityTable").find(".dataFlag").change()});$(".allReport").on("change",function(){$("#communityTable").find(".reportFlag").prop("checked",$(".allReport").prop("checked"));$("#communityTable").find(".reportFlag").change()});$("#communityTable").on("change","input",function(){var n=$(this).closest("tr"),t=n[0].id,i=$("#applicationStatus option:selected").val(),r=n.find(".dataFlag").prop("checked"),u=n.find(".reportFlag").prop("checked");$.ajax({url:path+"AccessAdmin/SetCommunityInfo",type:"POST",data:{communityId:i,applicationId:t,dataFlag:r,reportFlag:u}}).done(function(t){t.Success?(n.find(".notExists").hide(),n.find(".exists").show()):alert("Unable to set flags, server may be down, try again")}).fail(function(){alert("Unable to set flags, server may be down, try again")})});$("#applicationStatus").on("change",function(){var n=$("#applicationStatus option:selected").val();getApplicationCommunityInfo(n)});var n=$("#applicationStatus option:selected").val();getApplicationCommunityInfo(n)}function getApplicationCommunityInfo(n){$.ajax({url:path+"AccessAdmin/GetCommunityInfo",type:"POST",data:{communityId:n}}).done(function(n){var t;for($(".allDataEntry").prop("checked",!1),$(".allReport").prop("checked",!1),$("#communityTable").find(".notExists").show(),$("#communityTable").find(".exists").hide(),$("#communityTable").find(".dataFlag").prop("checked",!1),$("#communityTable").find(".reportFlag").prop("checked",!1),t=0;t<n.length;t++){var r=n[t].ApplicationId,u=n[t].DataEntryFlg,f=n[t].ReportFlg,i=$("#communityTable").find("#"+r);i.find(".notExists").hide();i.find(".exists").show();i.find(".dataFlag").prop("checked",u);i.find(".reportFlag").prop("checked",f)}})}function initPage(){$("#tabs").tabs();$("#tabs").tabs({activate:function(n,t){var r=t.newPanel.find(".dataTable").filter(function(){return this.id!=""}),u;for(i=0;i<r.length;i++)u=$("#"+r[i].id).dataTable(),u.fnAdjustColumnSizing()}});initGeneralAccess();initObjectAccess();initAdminAccess();initCommunityStatus();$(".ui-tabs-nav").css("display","inline-block")}function getAdminList(n){$.ajax({url:path+"AccessAdmin/GetAdminAccess",type:"POST",data:{appId:n}}).done(function(n){var r=$("#adminUsers").DataTable(),u,t,i;for(r.clear(),u=[],t=0;t<n.length;t++)i=[],i.push(n[t].UserDisplayName),i.push(n[t].AccountName),i.push("<a href='"+path+"UserAdmin?id="+n[t].UserId+"' target='_blank'>Manage<\/a>"),u.push(i);r.rows.add(u);r.draw();r.columns.adjust()})}function getObjectUserAccess(n){$.ajax({url:path+"AccessAdmin/GetObjectAccess",type:"POST",data:{objectId:n}}).done(function(n){var r=$("#objectUsers").DataTable(),u,t,i;for(r.clear(),u=[],t=0;t<n.length;t++)i=[],i.push(n[t].UserDisplayName),i.push(n[t].AccountName),i.push("<a href='"+path+"UserAdmin?id="+n[t].UserId+"' target='_blank'>Manage<\/a>"),u.push(i);r.rows.add(u);r.draw();r.columns.adjust()})}function setObjectUserAccess(n,t){$.ajax({url:path+"AccessAdmin/SetObjectAccess",type:"POST",data:{objectId:n,allow:t}}).done(function(n){n.Success||alert("Error setting access, the server may be down, try again.")})}function setApplicationUserAccess(n,t){$.ajax({url:path+"AccessAdmin/SetAppAccess",type:"POST",data:{appId:n,allow:t}}).done(function(n){n.Success||alert("Error setting access, the server may be down, try again.")})}function getApplicationUserAccess(n){$.ajax({url:path+"AccessAdmin/GetAppAccess",method:"POST",data:{appId:n}}).done(function(n){var r=$("#appUsers").DataTable(),u,t,i;for(r.clear(),u=[],t=0;t<n.length;t++)i=[],i.push(n[t].UserDisplayName),i.push(n[t].AccountName),i.push("<a href='"+path+"UserAdmin?id="+n[t].UserId+"' target='_blank'>Manage<\/a>"),u.push(i);r.rows.add(u);r.draw()})}var test;$(document).ajaxSend(function(){ShowProgress()});$(document).ajaxComplete(function(){HideProgress()});initPage();