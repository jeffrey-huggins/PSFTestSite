function loadTabs(){loadEquipmentTab();loadUpcomingTab();loadPastDueTab()}function setupEvents(){$("#communitySelector").change(function(){$("#detailsSection").html("");loadTabs()});$("#addEquipment").on("click",function(n){n.preventDefault();var t=$("#communitySelector").val();editEquipment(this.href+"?communityId="+t)})}function loadEquipmentTab(){var n=$("#communitySelector").val();$("#equipmentTab").load(path+"EquipmentManagement/EquipmentList?communityId="+n,setupEquipmentTab)}function loadUpcomingTab(){var n=$("#communitySelector").val();$("#upcomingTab").load(path+"EquipmentManagement/PlanList?upcoming=true&communityId="+n,setupUpcomingTab)}function loadPastDueTab(){var n=$("#communitySelector").val();$("#pastDueTab").load(path+"EquipmentManagement/PlanList?upcoming=false&communityId="+n,setupPastDueTab)}function setupEquipmentTab(){var n=$("#equipmentTable").DataTable({columnDefs:[{targets:"noSort",orderable:!1,searchable:!1}],autoWidth:!1,width:800,paging:!1});$("#equipmentTable").on("click",".edit",function(n){n.preventDefault();editEquipment(this.href)});$("#equipmentTable").on("click",".details",function(n){n.preventDefault();loadDetails(this.href)});$("#equipmentTable").on("click",".newRepair",function(n){n.preventDefault();editRepair(this.href)});$("#equipmentTable").on("click",".newPlan",function(n){n.preventDefault();editPlan(this.href)})}function setupUpcomingTab(){$("#upcomingTab").find(".planTable").DataTable({columnDefs:[{targets:"noSort",orderable:!1,searchable:!1},],order:[[3,"desc"]],language:{emptyTable:"No Plans for this equipment exist"},paging:!1});$("#upcomingTab").on("click",".newInspection",function(n){n.preventDefault();editInspection(this.href)});$("#upcomingTab").on("click",".edit",function(n){n.preventDefault();editPlan(this.href)})}function setupPastDueTab(){$("#pastDueTab").find(".planTable").DataTable({columnDefs:[{targets:"noSort",orderable:!1,searchable:!1}],language:{emptyTable:"No Plans for this equipment exist"},paging:!1});$("#pastDueTab").on("click",".newInspection",function(n){n.preventDefault();editInspection(this.href)});$("#pastDueTab").on("click",".edit",function(n){n.preventDefault();editPlan(this.href)})}function editEquipment(n){$("#modal").load(n,function(){$("#modal").dialog({height:360,width:"auto",resize:"auto",modal:!0});$("#EquipmentId").val()=="0"&&($("#LifeExpectancyCnt").val(""),$("#PurchaseDate").val(""),$("#InstalledDate").val(""));$("#vendorDropDown").chosen({no_results_text:"no matches found!",width:"200px",height:"100px"});$(".date-picker").datepicker({onSelect:function(){$(this).parent().focus()}});$("#equipmentSubmit").on("click",function(n){n.preventDefault();var t=$("#saveEquipmentForm");t.valid()&&t.ajaxSubmit({success:function(n){n.success&&(loadEquipmentTab(),reloadDetails(),$("#modal").dialog("close"))}})})})}function editPlan(n){$("#modal").load(n,function(){$("#modal").dialog({height:360,width:"auto",resize:"auto",modal:!0});$(".date-picker").datepicker({onSelect:function(){$(this).parent().focus()}});$("#EquipmentMaintenancePlanId").val()=="0"&&$("#StartDate").val("");$("#planSubmit").on("click",function(n){n.preventDefault();var t=$("#savePlanForm");t.valid()&&t.ajaxSubmit({success:function(n){n.success&&(loadTabs(),reloadDetails(),$("#modal").dialog("close"))}})})})}function editRepair(n){$("#modal").load(n,function(){$("#modal").dialog({height:400,width:700,modal:!0});$("#addDocument").on("click",function(){var n=$(".documentRow").length;$("#documentSection").append($("<div>").load(path+"EquipmentManagement/NewDocument?index="+n))});$("#repairSubmit").on("click",function(n){n.preventDefault();var t=$("#saveRepairForm");t.valid()&&t.ajaxSubmit({dataType:"json",iframe:!0,success:function(n){n.success&&(loadTabs(),reloadDetails(),$("#modal").dialog("close"))}})})})}function editInspection(n){$("#modal").load(n,function(){$("#modal").dialog({height:400,width:700});$("#addDocument").on("click",function(){var n=$(".documentRow").length;$("#documentSection").append($("<div>").load(path+"EquipmentManagement/NewDocument?index="+n))});$("#saveInspection").on("click",function(n){n.preventDefault();var t=$("#saveInspectionForm");t.valid()&&t.ajaxSubmit({dataType:"json",iframe:!0,success:function(n){n.success&&(loadTabs(),reloadDetails(),$("#modal").dialog("close"))}})})})}function loadDetails(n){$("#detailsSection").load(n,function(){$("#detailsSection").find(".tabs").tabs();$("#closeDetails").on("click",function(){$("#detailsSection").html("")});$(".newRepair").on("click",function(n){n.preventDefault();editRepair(this.href)});$(".edit").on("click",function(n){n.preventDefault();editPlan(this.href)});$(".vendorInfo").on("click",function(n){n.preventDefault();loadVendorInfo(this.href)});$(".newInspection").on("click",function(n){n.preventDefault();editInspection(this.href)});$(".dataToggle").on("click",function(n){n.preventDefault();$($(this).attr("data-target")).toggle("fast")})})}function loadVendorInfo(n){$("#modal").load(n,function(){$("#modal").dialog({height:"auto",width:"auto",resize:"auto"})})}function reloadDetails(){var n=$("#equipmentDetailsId");n.length>0&&loadDetails(path+"EquipmentManagement/EquipmentDetails?equipmentId="+n.val())}$(document).ready(function(){$(".tabs").tabs();setupEvents();loadTabs()});