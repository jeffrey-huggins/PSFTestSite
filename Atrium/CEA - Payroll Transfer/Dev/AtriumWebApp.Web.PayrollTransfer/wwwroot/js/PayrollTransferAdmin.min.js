function CommunityAdminTable(n){this.dataTable=$(n).dataTable({bFilter:!1,bAutoWidth:!1,aaSorting:[],sScrollY:"600px",sDom:"frtS",iDisplayLength:-1,aoColumns:[null,null,null,{bSearchable:!1,bSortable:!1,sWidth:"50px"},{bSearchable:!1,bSortable:!1,sWidth:"50px"}],oLanguage:{sEmptyTable:"No Communities"}});this.wireupDisplayUpdateHandler=function(n){$(".checkboxDisplay").click(function(){var t=$(this).is(":checked"),i=$(this).attr("id"),r=$(this).parents("tr").children(":first-child").text();$.ajax({url:n,dataType:"json",cache:!1,type:"POST",data:{community:i,dFlag:t,appCode:"PRTR"},success:function(n){n.Success||alert("Community has failed to be enabled/disabled. Please try again and if you see this message repeatedly the server may be down.")}})})};this.wireupReportUpdateHandler=function(n){$(".checkboxReport").click(function(){var t=$(this).is(":checked"),i=$(this).attr("id"),r=$(this).parents("tr").children(":first-child").text();$.ajax({url:n,dataType:"json",cache:!1,type:"POST",data:{community:i,dFlag:t,appCode:"PRTR"},success:function(n){n.Success||alert("Community report flag has failed to be enabled/disabled. Please try again and if you see this message repeatedly the server may be down.")}})})}}function initContractorTable(){var n=null,t=$("#contractor-table").dataTable({bFilter:!1,bAutoWidth:!1,sDom:"frtS",iDisplayLength:-1,aoColumns:[{sWidth:"150px"},{sWidth:"150px"},{sWidth:"200px"},{bSortable:!1}],oLanguage:{sEmptyTable:"No Communities"}});$("#contractor-table").on("click","a.delete",function(n){n.preventDefault();var i=$(this).parents("tr")[0],r=$(this).closest("tr").attr("id"),f=t.fnGetData(i),u=confirm("Are you sure you want to delete?");u&&$.ajax({url:path+"PayrollTransferAdmin/DeleteContractor",dataType:"json",cache:!1,type:"POST",data:{id:r},success:function(n){n.Success?t.fnDeleteRow(i):n.Message?alert(n.Message):alert("Contractor has failed to be deleted. Please try again and if you see this message repeatedly the server may be down.")}})});$("#contractor-table").on("click","a.edit",function(i){var r,u,f;i.preventDefault();r=$(this).parents("tr")[0];n!==null&&n!=r?(restoreRow(t,n),editRow(t,r),n=r):n==r&&this.innerHTML=="Save"?(u=$(this).closest("tr").attr("id"),f=saveRow(t,n,u),f&&(n=null)):(editRow(t,r),n=r)});$("#contractor-table").on("click","a.cancel",function(n){n.preventDefault();var i=$(this).parents("tr")[0];restoreRow(t,i)});$("#contractor-table").on("click",".select-communities",function(n){n.preventDefault();var t=$("#communityAssocationModal");$.ajax({url:this.href,success:function(n){var i=$("<div />"),r,u;i.addClass("modal");$("body").append(i);t.html(n);t.show();r=Math.max($(window).height()/2-t[0].offsetHeight/2,0);u=Math.max($(window).width()/2-t[0].offsetWidth/2,0);t.css({top:r,left:u});communitySelectionsTable=$("#selectedCommunities",t).dataTable({bFilter:!1,bAutoWidth:!1,sScrollY:"370px",sDom:"frtS",iDisplayLength:-1,aoColumns:[{sWidth:"500px"},{sWidth:"100px",bSortable:!1}],oLanguage:{sEmptyTable:"No Communities"}})},error:function(){alert("Could not communicate with the server.")}})});$("#contractorTab input[type='submit']").on("click",function(n){n.preventDefault();var t=$("#contractorTab form"),i=$("#contractor-table").dataTable();if(!t.valid())return!1;$.ajax({url:t.attr("action"),dataType:"json",type:"POST",data:t.serialize(),success:function(n){if(n.Success){var u=n.data.FirstName,r=n.data.PTContractorId,f=n.data.LastName,e=n.data.VendorNbr,o=i.fnAddData([u,f,e,'<a href= "" class="edit" >Edit<\/a > | <a class="select-communities" href="'+path+"PayrollTransferAdmin/GetCommunityAssociations/"+r+'">Associate Communities<\/a> | <a href="" class="delete">Delete<\/a>']),s=i.fnSettings().aoData[o[0]].nTr;s.setAttribute("id",r);t[0].reset()}else console.log(n),alert(n.message)},error:function(){alert("Server is not responding. Please reload page and try again")}})})}function initCommunitAssociation(){var n=$("#communityAssocationModal");n.on("click","#close",function(){$(".modal").hide();n.hide()});n.on("change",".selectCommunity",function(){var i=$(this),t=$(this).is(":checked"),r=$(this).parents("tr")[0],u=$(this).closest("tr").attr("id"),f=$("#selectedCommunities",n).dataTable(),o=f.fnGetData(r),e=$("#ContractorId").val();$.ajax({url:path+"PayrollTransferAdmin/ChangeCommunityAssociation",dataType:"json",cache:!1,type:"POST",data:{contractorId:e,communityId:u,isAssociated:t},success:function(n){n.Success||(i.prop("checked",!t),alert("Hospital has failed to be associated. Please try again and if you see this message repeatedly the server may be down."))},error:function(){alert("Error communicating with server.")}})})}function restoreRow(n,t){for(var r=n.fnGetData(t),u=$(">td",t),i=0,f=u.length;i<f;i++)n.fnUpdate(r[i],t,i,!1)}function editRow(n,t){var r=n.fnGetData(t),i=$(">td",t);i[0].innerHTML='<input type="text" value="'+r[0]+'"/>';i[1].innerHTML='<input type="text" value="'+r[1]+'"/>';i[2].innerHTML='<input type="text" value="'+r[2]+'"/>';i[3].innerHTML='<a class="edit" href="">Save<\/a> <a class="cancel" href="">Cancel<\/a>'}function saveRow(n,t,i){var r=$("input",t);return $.ajax({url:path+"PayrollTransferAdmin/EditContractor",dataType:"json",cache:!1,type:"POST",data:{id:i,firstName:r[0].value,lastName:r[1].value,vendorNbr:r[2].value},success:function(u){u.Success&&(n.fnUpdate(r[0].value,t,0,!1),n.fnUpdate(r[1].value,t,1,!1),n.fnUpdate(r[2].value,t,2,!1),n.fnUpdate('<a class="edit" href="">Edit<\/a> | <a class="select-communities" href="'+path+"PayrollTransferAdmin/GetCommunityAssociations/"+i+'">Associate Communities<\/a> | <a href="" class="delete">Delete<\/a>',t,3,!1))},error:function(){alert("Server is not responding. Please reload page and try again")}}),!0}var PurchaseOrderAdmin=function(){return $("#NewType").keyup(function(){$("#NewType").val().trim()?$("#NewTypeSubmit").prop("disabled",!1):$("#NewTypeSubmit").prop("disabled",!0)}),$("#NewVendorClass").keyup(function(){$("#NewVendorClass").val().trim()?$("#NewVendorSubmit").prop("disabled",!1):$("#NewVendorSubmit").prop("disabled",!0)}),$("#NewAssetClass").keyup(function(){$("#NewAssetClass").val().trim()?$("#NewAssetSubmit").prop("disabled",!1):$("#NewAssetSubmit").prop("disabled",!0)}),$("#NewApprover").keyup(function(){$("#NewApprover").val().trim()?$("#NewApproverSubmit").prop("disabled",!1):$("#NewApproverSubmit").prop("disabled",!0)}),{setupCommunityTable:function(n,t,i){var r=new CommunityAdminTable(n);return r.wireupDisplayUpdateHandler(t),r.wireupReportUpdateHandler(i),r}}}();$(document).ready(function(){$("#tabs").tabs();initContractorTable();initCommunitAssociation();PurchaseOrderAdmin.setupCommunityTable("#CommunityTable",path+"PayrollTransferAdmin/ChangeDataFlgCom",path+"PayrollTransferAdmin/ChangeReportFlgCom");$("#tabs").tabs({activate:function(n,t){var r=t.newPanel.find(".dataTable").filter(function(){return this.id!=""}),u;for(i=0;i<r.length;i++)u=$("#"+r[i].id).dataTable(),u.fnAdjustColumnSizing()}})});$(document).ajaxSend(function(){ShowProgress()});$(document).ajaxComplete(function(){HideProgress()});