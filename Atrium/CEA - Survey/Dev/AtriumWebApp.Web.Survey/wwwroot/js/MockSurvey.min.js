function PreparePage(n){function r(){$("#CloseSignature").prop("disabled")||$("#CloseSignature").prop("disabled",!$("#Close").prop("checked"));$(".isDate").datepicker()}var t=$("#formContent"),i;$("#MockSurveyId").length!==1&&t.hide();i=$("#MockSurveys").dataTable({bAutoWidth:!1,bSmart:!1,sScrollY:"400px",sDom:"rt",iDisplayLength:-1,aaSorting:[[0,"desc"]],aoColumns:[null,null,null,null,null,{sWidth:"30px",bSearchable:!1,bSortable:!1},{sWidth:"40px",bSearchable:!1,bSortable:!1},{sWidth:"50px",bSearchable:!1,bSortable:!1}],oLanguage:{sEmptyTable:"No current Mock Surveys for Community"}});i.on("click",".delete-link",function(n){var r=$(this);n.preventDefault();confirm("Are you sure you would like to delete this mock survey?")&&(ShowProgress(),$.ajax({url:r.attr("href"),type:"post",success:function(){var n=r.closest("tr"),u=n.get(0),f=i.fnGetPosition(u);i.fnDeleteRow(f);n.attr("id")==$("#MockSurveyId").val()&&t.hide();SetCountDownTime(1800)},error:function(){alert("Could not communicate with the server.")},complete:function(){HideProgress()}}))});i.on("click","a.edit-link",function(n){n.preventDefault();ShowProgress();$.ajax({url:this.href,success:function(n){t.html(n);t.show();r()},error:function(){alert("Server is not responding. Please reload page and try again")},complete:function(){HideProgress()}})});i.on("click","a.follow-up-link",function(n){n.preventDefault();ShowProgress();$.ajax({url:this.href,success:function(n){t.html(n);t.show()},error:function(){alert("Server is not responding. Please reload page and try again")},complete:function(){HideProgress()}})});$("#create").click(function(u){var f=$("#CurrentCommunity"),e=$("option:selected",f).text(),o=this.href+"/"+e;u.preventDefault();ShowProgress();$.ajax({url:o,type:"POST",success:function(u){t.html(u);t.show();r();var f=$("#MockSurveyId").val(),e=[$("#MockSurveyDate").val(),"","","","",'<a class="edit-link" href="'+n+"/Edit/"+f+'">Edit<\/a>','<a class="delete-link" href="'+n+"/Delete/"+f+'">Delete<\/a>',""],o=i.fnAddData(e,!0),s=i.fnSettings().aoData[o[0]].nTr;s.setAttribute("id",f);SetCountDownTime(1800)},error:function(){alert("Server is not responding. Please reload page and try again")},complete:function(){HideProgress()}})});t.on("click","#Save",function(u){var e=$("#MockSurvey"),f=e.serialize();u.preventDefault();ShowProgress();$.ajax({type:e.attr("method"),url:e.attr("action"),data:f,success:function(u){var o,s,h,c;u.Success?(o=$("#MockSurveyId",e).val(),s=$("#"+o),s.length>0&&(h=i.fnGetData(s.get(0)),c=[$("#MockSurveyDate").val(),u.FormattedClosedDate,$("#FollowUpDate").val(),h[3],h[4],f.IsClosed&&!f.IsAdministrator?"":'<a class="edit-link" href="'+n+"/Edit/"+o+'">Edit<\/a>',f.IsClosed&&!f.IsAdministrator?"":'<a class="delete-link" href="'+n+"/Delete/"+o+'">Delete<\/a>',h[7]],i.fnUpdate(c,s[0])),t.hide()):(t.html(u),r());SetCountDownTime(1800)},error:function(){alert("Server is not responding. Please reload page and try again")},complete:function(){HideProgress()}})});t.on("click","#SaveFollowUp",function(r){var u=$("#FollowUp"),f=u.serialize();r.preventDefault();ShowProgress();$.ajax({type:u.attr("method"),url:u.attr("action"),data:f,success:function(r){var s,o,e,h;r.Success?(s=$("#MockSurveyId",u).val(),o=$("#"+s),o.length>0&&(e=i.fnGetData(o.get(0)),h=[e[0],e[1],e[2],e[3],r.FormattedClosedDate,e[5],e[6],f.IsClosed&&!f.IsAdministrator?"":'<a class="follow-up-link" href="'+n+"/FollowUp/"+s+'">Follow-up<\/a>'],i.fnUpdate(h,o[0])),t.hide()):t.html(r);SetCountDownTime(1800)},error:function(){alert("Server is not responding. Please reload page and try again")},complete:function(){HideProgress()}})});t.on("change","#Close",function(){$("#CloseSignature").prop("disabled",!this.checked)});$("#CurrentCommunity").change(function(){var n=$("#CurrentCommunity").val();n!=""&&$("#CommunitySelectionForm").submit()});$(".isDate").datepicker();$("#ToDateRangeInvalid").val()=="1"&&alert('Error: Please enter a valid date in the Date Range "To" Field (mm/dd/yyyy)');$("#FromDateRangeInvalid").val()=="1"&&alert('Error: Please enter a valid date in the Date Range "From" Field (mm/dd/yyyy)');$("#ToDateRangeInFuture").val()=="1"&&alert('Error: Please enter a valid date that is not in the future in the Date Range "To" Field');$("#FromDateRangeInFuture").val()=="1"&&alert('Error: Please enter a valid date that is not in the future in the Date Range "From" Field');$("#FromAfterTo").val()=="1"&&alert('Error: You can not have the "From" Date after the "To" Date in the Date Range Fields')}